import{i as t,p as e}from"./DyQHLcRc.js";import"./BjEUid_f.js";import"./BHSXa98A.js";import"./CD87zYRD.js";import"./o6e2QqfC.js";import"./BRAjhoyJ.js";import"./DiO10Rho.js";import"./DeyDsNem.js";import"./DorN1uFa.js";import{g as a,h as n}from"./BSkwur-o.js";import{B as i,C as r,U as l,_ as o,a as s,b as p,c,d as u,v as d,z as f}from"./BwMZNxBp.js";import{t as m}from"./me088uMJ.js";import{n as g}from"./Choa3_ca.js";import{p as h}from"./C4qSHt3C.js";import{t as x}from"./VSqzENiA.js";import{t as y}from"./E-nZgtXn.js";import{t as w}from"./Dh1gMkp-.js";import"./DI-xg2r2.js";import{t as S}from"./BvvUrDlJ.js";import{t as v}from"./p9A8sgkw.js";function $(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function j(t){return t}var b=u.pie,A={sections:new Map,showData:!1,config:b},C=A.sections,T=A.showData,D=structuredClone(b),k={getConfig:n(()=>structuredClone(D),"getConfig"),clear:n(()=>{C=new Map,T=A.showData,s()},"clear"),setDiagramTitle:l,getDiagramTitle:r,setAccTitle:i,getAccTitle:d,setAccDescription:f,getAccDescription:o,addSection:n(({label:t,value:e})=>{if(e<0)throw new Error(`"${t}" has invalid value: ${e}. Negative values are not allowed in pie charts. All slice values must be >= 0.`);C.has(t)||(C.set(t,e),a.debug(`added new section: ${t}, with value: ${e}`))},"addSection"),getSections:n(()=>C,"getSections"),setShowData:n(t=>{T=t},"setShowData"),getShowData:n(()=>T,"getShowData")},M=n((t,e)=>{S(t,e),e.setShowData(t.showData),t.sections.map(e.addSection)},"populateDb"),z={parse:n(async t=>{const e=await v("pie",t);a.debug(e),M(e,k)},"parse")},O=n(t=>`\n  .pieCircle{\n    stroke: ${t.pieStrokeColor};\n    stroke-width : ${t.pieStrokeWidth};\n    opacity : ${t.pieOpacity};\n  }\n  .pieOuterCircle{\n    stroke: ${t.pieOuterStrokeColor};\n    stroke-width: ${t.pieOuterStrokeWidth};\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ${t.pieTitleTextSize};\n    fill: ${t.pieTitleTextColor};\n    font-family: ${t.fontFamily};\n  }\n  .slice {\n    font-family: ${t.fontFamily};\n    fill: ${t.pieSectionTextColor};\n    font-size:${t.pieSectionTextSize};\n    // fill: white;\n  }\n  .legend text {\n    fill: ${t.pieLegendTextColor};\n    font-family: ${t.fontFamily};\n    font-size: ${t.pieLegendTextSize};\n  }\n`,"getStyles"),F=n(t=>{const e=[...t.values()].reduce((t,e)=>t+e,0),a=[...t.entries()].map(([t,e])=>({label:t,value:e})).filter(t=>t.value/e*100>=1).sort((t,e)=>e.value-t.value);return function(){var t=j,e=$,a=null,n=g(0),i=g(h),r=g(0);function l(l){var o,s,p,c,u,d=(l=y(l)).length,f=0,m=new Array(d),g=new Array(d),x=+n.apply(this,arguments),w=Math.min(h,Math.max(-h,i.apply(this,arguments)-x)),S=Math.min(Math.abs(w)/d,r.apply(this,arguments)),v=S*(w<0?-1:1);for(o=0;o<d;++o)(u=g[m[o]=o]=+t(l[o],o,l))>0&&(f+=u);for(null!=e?m.sort(function(t,a){return e(g[t],g[a])}):null!=a&&m.sort(function(t,e){return a(l[t],l[e])}),o=0,p=f?(w-d*v)/f:0;o<d;++o,x=c)s=m[o],c=x+((u=g[s])>0?u*p:0)+v,g[s]={data:l[s],index:o,value:u,startAngle:x,endAngle:c,padAngle:S};return g}return l.value=function(e){return arguments.length?(t="function"==typeof e?e:g(+e),l):t},l.sortValues=function(t){return arguments.length?(e=t,a=null,l):e},l.sort=function(t){return arguments.length?(a=t,e=null,l):a},l.startAngle=function(t){return arguments.length?(n="function"==typeof t?t:g(+t),l):n},l.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:g(+t),l):i},l.padAngle=function(t){return arguments.length?(r="function"==typeof t?t:g(+t),l):r},l}().value(t=>t.value)(a)},"createPieArcs"),R={parser:z,db:k,renderer:{draw:n((n,i,r,l)=>{a.debug("rendering pie chart\n"+n);const o=l.db,s=p(),u=t(o.getConfig(),s.pie),d=18,f=450,g=f,h=w(i),y=h.append("g");y.attr("transform","translate(225,225)");const{themeVariables:S}=s;let[v]=e(S.pieOuterStrokeWidth);v??=2;const $=u.textPosition,j=Math.min(g,f)/2-40,b=x().innerRadius(0).outerRadius(j),A=x().innerRadius(j*$).outerRadius(j*$);y.append("circle").attr("cx",0).attr("cy",0).attr("r",j+v/2).attr("class","pieOuterCircle");const C=o.getSections(),T=F(C),D=[S.pie1,S.pie2,S.pie3,S.pie4,S.pie5,S.pie6,S.pie7,S.pie8,S.pie9,S.pie10,S.pie11,S.pie12];let k=0;C.forEach(t=>{k+=t});const M=T.filter(t=>"0"!==(t.data.value/k*100).toFixed(0)),z=m(D);y.selectAll("mySlices").data(M).enter().append("path").attr("d",b).attr("fill",t=>z(t.data.label)).attr("class","pieCircle"),y.selectAll("mySlices").data(M).enter().append("text").text(t=>(t.data.value/k*100).toFixed(0)+"%").attr("transform",t=>"translate("+A.centroid(t)+")").style("text-anchor","middle").attr("class","slice"),y.append("text").text(o.getDiagramTitle()).attr("x",0).attr("y",-200).attr("class","pieTitleText");const O=[...C.entries()].map(([t,e])=>({label:t,value:e})),R=y.selectAll(".legend").data(O).enter().append("g").attr("class","legend").attr("transform",(t,e)=>"translate(216,"+(22*e-22*O.length/2)+")");R.append("rect").attr("width",d).attr("height",d).style("fill",t=>z(t.label)).style("stroke",t=>z(t.label)),R.append("text").attr("x",22).attr("y",14).text(t=>o.getShowData()?`${t.label} [${t.value}]`:t.label);const W=512+Math.max(...R.selectAll("text").nodes().map(t=>t?.getBoundingClientRect().width??0));h.attr("viewBox",`0 0 ${W} 450`),c(h,f,W,u.useMaxWidth)},"draw")},styles:O};export{R as diagram};