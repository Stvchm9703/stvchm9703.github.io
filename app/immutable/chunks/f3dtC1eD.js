import{a as t,p as e,r as a,u as s}from"./BrovVaEf.js";import{g as n,h as r,p as l}from"./C7VJpUc4.js";import{A as i,I as o,L as h,N as c,O as d,b as g,d as y,h as p,s as u,y as f}from"./Mg0B-8hR.js";import{n as m,r as x}from"./ATHKqhQU.js";import{t as b}from"./CRwbC9jC.js";import{a as w,i as S,r as k,t as $}from"./Doc76i9g.js";function M(t,e,a){if(t&&t.length){const[s,n]=e,r=Math.PI/180*a,l=Math.cos(r),i=Math.sin(r);for(const e of t){const[t,a]=e;e[0]=(t-s)*l-(a-n)*i+s,e[1]=(t-s)*i+(a-n)*l+n}}}function v(t,e){return t[0]===e[0]&&t[1]===e[1]}function D(t,e){var a;const s=e.hachureAngle+90;let n=e.hachureGap;n<0&&(n=4*e.strokeWidth),n=Math.round(Math.max(n,.1));let r=1;return e.roughness>=1&&((null===(a=e.randomizer)||void 0===a?void 0:a.next())||Math.random())>.7&&(r=n),function(t,e,a,s=1){const n=a,r=Math.max(e,.1),l=t[0]&&t[0][0]&&"number"==typeof t[0][0]?[t]:t,i=[0,0];if(n)for(const h of l)M(h,i,n);const o=function(t,e,a){const s=[];for(const h of t){const t=[...h];v(t[0],t[t.length-1])||t.push([t[0][0],t[0][1]]),t.length>2&&s.push(t)}const n=[];e=Math.max(e,.1);const r=[];for(const h of s)for(let t=0;t<h.length-1;t++){const e=h[t],a=h[t+1];if(e[1]!==a[1]){const t=Math.min(e[1],a[1]);r.push({ymin:t,ymax:Math.max(e[1],a[1]),x:t===e[1]?e[0]:a[0],islope:(a[0]-e[0])/(a[1]-e[1])})}}if(r.sort((t,e)=>t.ymin<e.ymin?-1:t.ymin>e.ymin?1:t.x<e.x?-1:t.x>e.x?1:t.ymax===e.ymax?0:(t.ymax-e.ymax)/Math.abs(t.ymax-e.ymax)),!r.length)return n;let l=[],i=r[0].ymin,o=0;for(;l.length||r.length;){if(r.length){let t=-1;for(let e=0;e<r.length&&!(r[e].ymin>i);e++)t=e;r.splice(0,t+1).forEach(t=>{l.push({s:i,edge:t})})}if(l=l.filter(t=>!(t.edge.ymax<=i)),l.sort((t,e)=>t.edge.x===e.edge.x?0:(t.edge.x-e.edge.x)/Math.abs(t.edge.x-e.edge.x)),(1!==a||o%e==0)&&l.length>1)for(let t=0;t<l.length;t+=2){const e=t+1;if(e>=l.length)break;const a=l[t].edge,s=l[e].edge;n.push([[Math.round(a.x),i],[Math.round(s.x),i]])}i+=a,l.forEach(t=>{t.edge.x=t.edge.x+a*t.edge.islope}),o++}return n}(l,r,s);if(n){for(const t of l)M(t,i,-n);!function(t,e,a){const s=[];t.forEach(t=>s.push(...t)),M(s,e,a)}(o,i,-n)}return o}(t,n,s,r||1)}var C=class{constructor(t){this.helper=t}fillPolygons(t,e){return this._fillPolygons(t,e)}_fillPolygons(t,e){const a=D(t,e);return{type:"fillSketch",ops:this.renderLines(a,e)}}renderLines(t,e){const a=[];for(const s of t)a.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],e));return a}};function P(t){const e=t[0],a=t[1];return Math.sqrt(Math.pow(e[0]-a[0],2)+Math.pow(e[1]-a[1],2))}var B=class extends C{fillPolygons(t,e){let a=e.hachureGap;a<0&&(a=4*e.strokeWidth),a=Math.max(a,.1);const s=D(t,Object.assign({},e,{hachureGap:a})),n=Math.PI/180*e.hachureAngle,r=[],l=.5*a*Math.cos(n),i=.5*a*Math.sin(n);for(const[o,h]of s)P([o,h])&&r.push([[o[0]-l,o[1]+i],[...h]],[[o[0]+l,o[1]-i],[...h]]);return{type:"fillSketch",ops:this.renderLines(r,e)}}},A=class extends C{fillPolygons(t,e){const a=this._fillPolygons(t,e),s=Object.assign({},e,{hachureAngle:e.hachureAngle+90}),n=this._fillPolygons(t,s);return a.ops=a.ops.concat(n.ops),a}},L=class{constructor(t){this.helper=t}fillPolygons(t,e){const a=D(t,e=Object.assign({},e,{hachureAngle:0}));return this.dotsOnLines(a,e)}dotsOnLines(t,e){const a=[];let s=e.hachureGap;s<0&&(s=4*e.strokeWidth),s=Math.max(s,.1);let n=e.fillWeight;n<0&&(n=e.strokeWidth/2);const r=s/4;for(const l of t){const t=P(l),i=t/s,o=Math.ceil(i)-1,h=t-o*s,c=(l[0][0]+l[1][0])/2-s/4,d=Math.min(l[0][1],l[1][1]);for(let l=0;l<o;l++){const t=d+h+l*s,i=c-r+2*Math.random()*r,o=t-r+2*Math.random()*r,g=this.helper.ellipse(i,o,n,n,e);a.push(...g.ops)}}return{type:"fillSketch",ops:a}}},N=class{constructor(t){this.helper=t}fillPolygons(t,e){const a=D(t,e);return{type:"fillSketch",ops:this.dashedLine(a,e)}}dashedLine(t,e){const a=e.dashOffset<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashOffset,s=e.dashGap<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashGap,n=[];return t.forEach(t=>{const r=P(t),l=Math.floor(r/(a+s)),i=(r+s-l*(a+s))/2;let o=t[0],h=t[1];o[0]>h[0]&&(o=t[1],h=t[0]);const c=Math.atan((h[1]-o[1])/(h[0]-o[0]));for(let d=0;d<l;d++){const t=d*(a+s),r=t+a,l=[o[0]+t*Math.cos(c)+i*Math.cos(c),o[1]+t*Math.sin(c)+i*Math.sin(c)],h=[o[0]+r*Math.cos(c)+i*Math.cos(c),o[1]+r*Math.sin(c)+i*Math.sin(c)];n.push(...this.helper.doubleLineOps(l[0],l[1],h[0],h[1],e))}}),n}},R=class{constructor(t){this.helper=t}fillPolygons(t,e){const a=e.hachureGap<0?4*e.strokeWidth:e.hachureGap,s=e.zigzagOffset<0?a:e.zigzagOffset,n=D(t,e=Object.assign({},e,{hachureGap:a+s}));return{type:"fillSketch",ops:this.zigzagLines(n,s,e)}}zigzagLines(t,e,a){const s=[];return t.forEach(t=>{const n=P(t),r=Math.round(n/(2*e));let l=t[0],i=t[1];l[0]>i[0]&&(l=t[1],i=t[0]);const o=Math.atan((i[1]-l[1])/(i[0]-l[0]));for(let h=0;h<r;h++){const t=2*h*e,n=2*(h+1)*e,r=Math.sqrt(2*Math.pow(e,2)),i=[l[0]+t*Math.cos(o),l[1]+t*Math.sin(o)],c=[l[0]+n*Math.cos(o),l[1]+n*Math.sin(o)],d=[i[0]+r*Math.cos(o+Math.PI/4),i[1]+r*Math.sin(o+Math.PI/4)];s.push(...this.helper.doubleLineOps(i[0],i[1],d[0],d[1],a),...this.helper.doubleLineOps(d[0],d[1],c[0],c[1],a))}}),s}},T={},I=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}},O={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function W(t,e){return t.type===e}function E(t){const e=[],a=function(t){const e=new Array;for(;""!==t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:0,text:RegExp.$1},t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];e[e.length]={type:1,text:`${parseFloat(RegExp.$1)}`},t=t.substr(RegExp.$1.length)}return e[e.length]={type:2,text:""},e}(t);let s="BOD",n=0,r=a[n];for(;!W(r,2);){let l=0;const i=[];if("BOD"===s){if("M"!==r.text&&"m"!==r.text)return E("M0,0"+t);n++,l=O[r.text],s=r.text}else W(r,1)?l=O[s]:(n++,l=O[r.text],s=r.text);if(!(n+l<a.length))throw new Error("Path data ended short");for(let t=n;t<n+l;t++){const e=a[t];if(!W(e,1))throw new Error("Param not a number: "+s+","+e.text);i[i.length]=+e.text}if("number"!=typeof O[s])throw new Error("Bad segment: "+s);{const t={key:s,data:i};e.push(t),n+=l,r=a[n],"M"===s&&(s="L"),"m"===s&&(s="l")}}return e}function _(t){let e=0,a=0,s=0,n=0;const r=[];for(const{key:l,data:i}of t)switch(l){case"M":r.push({key:"M",data:[...i]}),[e,a]=i,[s,n]=i;break;case"m":e+=i[0],a+=i[1],r.push({key:"M",data:[e,a]}),s=e,n=a;break;case"L":r.push({key:"L",data:[...i]}),[e,a]=i;break;case"l":e+=i[0],a+=i[1],r.push({key:"L",data:[e,a]});break;case"C":r.push({key:"C",data:[...i]}),e=i[4],a=i[5];break;case"c":{const t=i.map((t,s)=>s%2?t+a:t+e);r.push({key:"C",data:t}),e=t[4],a=t[5];break}case"Q":r.push({key:"Q",data:[...i]}),e=i[2],a=i[3];break;case"q":{const t=i.map((t,s)=>s%2?t+a:t+e);r.push({key:"Q",data:t}),e=t[2],a=t[3];break}case"A":r.push({key:"A",data:[...i]}),e=i[5],a=i[6];break;case"a":e+=i[5],a+=i[6],r.push({key:"A",data:[i[0],i[1],i[2],i[3],i[4],e,a]});break;case"H":r.push({key:"H",data:[...i]}),e=i[0];break;case"h":e+=i[0],r.push({key:"H",data:[e]});break;case"V":r.push({key:"V",data:[...i]}),a=i[0];break;case"v":a+=i[0],r.push({key:"V",data:[a]});break;case"S":r.push({key:"S",data:[...i]}),e=i[2],a=i[3];break;case"s":{const t=i.map((t,s)=>s%2?t+a:t+e);r.push({key:"S",data:t}),e=t[2],a=t[3];break}case"T":r.push({key:"T",data:[...i]}),e=i[0],a=i[1];break;case"t":e+=i[0],a+=i[1],r.push({key:"T",data:[e,a]});break;case"Z":case"z":r.push({key:"Z",data:[]}),e=s,a=n}return r}function j(t){const e=[];let a="",s=0,n=0,r=0,l=0,i=0,o=0;for(const{key:h,data:c}of t){switch(h){case"M":e.push({key:"M",data:[...c]}),[s,n]=c,[r,l]=c;break;case"C":e.push({key:"C",data:[...c]}),s=c[4],n=c[5],i=c[2],o=c[3];break;case"L":e.push({key:"L",data:[...c]}),[s,n]=c;break;case"H":s=c[0],e.push({key:"L",data:[s,n]});break;case"V":n=c[0],e.push({key:"L",data:[s,n]});break;case"S":{let t=0,r=0;"C"===a||"S"===a?(t=s+(s-i),r=n+(n-o)):(t=s,r=n),e.push({key:"C",data:[t,r,...c]}),i=c[0],o=c[1],s=c[2],n=c[3];break}case"T":{const[t,r]=c;let l=0,h=0;"Q"===a||"T"===a?(l=s+(s-i),h=n+(n-o)):(l=s,h=n);const d=s+2*(l-s)/3,g=n+2*(h-n)/3,y=t+2*(l-t)/3,p=r+2*(h-r)/3;e.push({key:"C",data:[d,g,y,p,t,r]}),i=l,o=h,s=t,n=r;break}case"Q":{const[t,a,r,l]=c,h=s+2*(t-s)/3,d=n+2*(a-n)/3,g=r+2*(t-r)/3,y=l+2*(a-l)/3;e.push({key:"C",data:[h,d,g,y,r,l]}),i=t,o=a,s=r,n=l;break}case"A":{const t=Math.abs(c[0]),a=Math.abs(c[1]),r=c[2],l=c[3],i=c[4],o=c[5],h=c[6];0===t||0===a?(e.push({key:"C",data:[s,n,o,h,o,h]}),s=o,n=h):s===o&&n===h||(z(s,n,o,h,t,a,r,l,i).forEach(function(t){e.push({key:"C",data:t})}),s=o,n=h);break}case"Z":e.push({key:"Z",data:[]}),s=r,n=l}a=h}return e}function H(t,e,a){return[t*Math.cos(a)-e*Math.sin(a),t*Math.sin(a)+e*Math.cos(a)]}function z(t,e,a,s,n,r,l,i,o,h){const c=(d=l,Math.PI*d/180);var d;let g=[],y=0,p=0,u=0,f=0;if(h)[y,p,u,f]=h;else{[t,e]=H(t,e,-c),[a,s]=H(a,s,-c);const l=(t-a)/2,h=(e-s)/2;let d=l*l/(n*n)+h*h/(r*r);d>1&&(d=Math.sqrt(d),n*=d,r*=d);const g=n*n,m=r*r,x=g*m-g*h*h-m*l*l,b=g*h*h+m*l*l,w=(i===o?-1:1)*Math.sqrt(Math.abs(x/b));u=w*n*h/r+(t+a)/2,f=w*-r*l/n+(e+s)/2,y=Math.asin(parseFloat(((e-f)/r).toFixed(9))),p=Math.asin(parseFloat(((s-f)/r).toFixed(9))),t<u&&(y=Math.PI-y),a<u&&(p=Math.PI-p),y<0&&(y=2*Math.PI+y),p<0&&(p=2*Math.PI+p),o&&y>p&&(y-=2*Math.PI),!o&&p>y&&(p-=2*Math.PI)}let m=p-y;if(Math.abs(m)>120*Math.PI/180){const t=p,e=a,i=s;p=o&&p>y?y+120*Math.PI/180*1:y+120*Math.PI/180*-1,g=z(a=u+n*Math.cos(p),s=f+r*Math.sin(p),e,i,n,r,l,0,o,[p,t,u,f])}m=p-y;const x=Math.cos(y),b=Math.sin(y),w=Math.cos(p),S=Math.sin(p),k=Math.tan(m/4),$=4/3*n*k,M=4/3*r*k,v=[t,e],D=[t+$*b,e-M*x],C=[a+$*S,s-M*w],P=[a,s];if(D[0]=2*v[0]-D[0],D[1]=2*v[1]-D[1],h)return[D,C,P].concat(g);{g=[D,C,P].concat(g);const t=[];for(let e=0;e<g.length;e+=3){const a=H(g[e][0],g[e][1],c),s=H(g[e+1][0],g[e+1][1],c),n=H(g[e+2][0],g[e+2][1],c);t.push([a[0],a[1],s[0],s[1],n[0],n[1]])}return t}}var q={randOffset:function(t,e){return at(t,e)},randOffsetWithRange:function(t,e,a){return et(t,e,a)},ellipse:function(t,e,a,s,n){return X(t,e,n,Z(a,s,n)).opset},doubleLineOps:function(t,e,a,s,n){return st(t,e,a,s,n,!0)}};function V(t,e,a,s,n){return{type:"path",ops:st(t,e,a,s,n)}}function F(t,e,a){const s=(t||[]).length;if(s>2){const n=[];for(let e=0;e<s-1;e++)n.push(...st(t[e][0],t[e][1],t[e+1][0],t[e+1][1],a));return e&&n.push(...st(t[s-1][0],t[s-1][1],t[0][0],t[0][1],a)),{type:"path",ops:n}}return 2===s?V(t[0][0],t[0][1],t[1][0],t[1][1],a):{type:"path",ops:[]}}function G(t,e){if(t.length){const a="number"==typeof t[0][0]?[t]:t,s=rt(a[0],1*(1+.2*e.roughness),e),n=e.disableMultiStroke?[]:rt(a[0],1.5*(1+.22*e.roughness),K(e));for(let t=1;t<a.length;t++){const r=a[t];if(r.length){const t=rt(r,1*(1+.2*e.roughness),e),a=e.disableMultiStroke?[]:rt(r,1.5*(1+.22*e.roughness),K(e));for(const e of t)"move"!==e.op&&s.push(e);for(const e of a)"move"!==e.op&&n.push(e)}}return{type:"path",ops:s.concat(n)}}return{type:"path",ops:[]}}function Z(t,e,a){const s=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(t/2,2)+Math.pow(e/2,2))/2)),n=Math.ceil(Math.max(a.curveStepCount,a.curveStepCount/Math.sqrt(200)*s)),r=2*Math.PI/n;let l=Math.abs(t/2),i=Math.abs(e/2);const o=1-a.curveFitting;return l+=at(l*o,a),i+=at(i*o,a),{increment:r,rx:l,ry:i}}function X(t,e,a,s){const[n,r]=it(s.increment,t,e,s.rx,s.ry,1,s.increment*et(.1,et(.4,1,a),a),a);let l=lt(n,null,a);if(!a.disableMultiStroke&&0!==a.roughness){const[n]=it(s.increment,t,e,s.rx,s.ry,1.5,0,a),r=lt(n,null,a);l=l.concat(r)}return{estimatedPoints:r,opset:{type:"path",ops:l}}}function Y(t,e,a,s,n,r,l,i,o){const h=t,c=e;let d=Math.abs(a/2),g=Math.abs(s/2);d+=at(.01*d,o),g+=at(.01*g,o);let y=n,p=r;for(;y<0;)y+=2*Math.PI,p+=2*Math.PI;p-y>2*Math.PI&&(y=0,p=2*Math.PI);const u=2*Math.PI/o.curveStepCount,f=Math.min(u/2,(p-y)/2),m=ot(f,h,c,d,g,y,p,1,o);if(!o.disableMultiStroke){const t=ot(f,h,c,d,g,y,p,1.5,o);m.push(...t)}return l&&(i?m.push(...st(h,c,h+d*Math.cos(y),c+g*Math.sin(y),o),...st(h,c,h+d*Math.cos(p),c+g*Math.sin(p),o)):m.push({op:"lineTo",data:[h,c]},{op:"lineTo",data:[h+d*Math.cos(y),c+g*Math.sin(y)]})),{type:"path",ops:m}}function Q(t,e){const a=j(_(E(t))),s=[];let n=[0,0],r=[0,0];for(const{key:l,data:i}of a)switch(l){case"M":r=[i[0],i[1]],n=[i[0],i[1]];break;case"L":s.push(...st(r[0],r[1],i[0],i[1],e)),r=[i[0],i[1]];break;case"C":{const[t,a,n,l,o,h]=i;s.push(...ht(t,a,n,l,o,h,r,e)),r=[o,h];break}case"Z":s.push(...st(r[0],r[1],n[0],n[1],e)),r=[n[0],n[1]]}return{type:"path",ops:s}}function J(t,e){const a=[];for(const s of t)if(s.length){const t=e.maxRandomnessOffset||0,n=s.length;if(n>2){a.push({op:"move",data:[s[0][0]+at(t,e),s[0][1]+at(t,e)]});for(let r=1;r<n;r++)a.push({op:"lineTo",data:[s[r][0]+at(t,e),s[r][1]+at(t,e)]})}}return{type:"fillPath",ops:a}}function U(t,e){return function(t,e){let a=t.fillStyle||"hachure";if(!T[a])switch(a){case"zigzag":T[a]||(T[a]=new B(e));break;case"cross-hatch":T[a]||(T[a]=new A(e));break;case"dots":T[a]||(T[a]=new L(e));break;case"dashed":T[a]||(T[a]=new N(e));break;case"zigzag-line":T[a]||(T[a]=new R(e));break;default:a="hachure",T[a]||(T[a]=new C(e))}return T[a]}(e,q).fillPolygons(t,e)}function K(t){const e=Object.assign({},t);return e.randomizer=void 0,t.seed&&(e.seed=t.seed+1),e}function tt(t){return t.randomizer||(t.randomizer=new I(t.seed||0)),t.randomizer.next()}function et(t,e,a,s=1){return a.roughness*s*(tt(a)*(e-t)+t)}function at(t,e,a=1){return et(-t,t,e,a)}function st(t,e,a,s,n,r=!1){const l=r?n.disableMultiStrokeFill:n.disableMultiStroke,i=nt(t,e,a,s,n,!0,!1);if(l)return i;const o=nt(t,e,a,s,n,!0,!0);return i.concat(o)}function nt(t,e,a,s,n,r,l){const i=Math.pow(t-a,2)+Math.pow(e-s,2),o=Math.sqrt(i);let h=1;h=o<200?1:o>500?.4:-.0016668*o+1.233334;let c=n.maxRandomnessOffset||0;c*c*100>i&&(c=o/10);const d=c/2,g=.2+.2*tt(n);let y=n.bowing*n.maxRandomnessOffset*(s-e)/200,p=n.bowing*n.maxRandomnessOffset*(t-a)/200;y=at(y,n,h),p=at(p,n,h);const u=[],f=()=>at(d,n,h),m=()=>at(c,n,h),x=n.preserveVertices;return r&&(l?u.push({op:"move",data:[t+(x?0:f()),e+(x?0:f())]}):u.push({op:"move",data:[t+(x?0:at(c,n,h)),e+(x?0:at(c,n,h))]})),l?u.push({op:"bcurveTo",data:[y+t+(a-t)*g+f(),p+e+(s-e)*g+f(),y+t+2*(a-t)*g+f(),p+e+2*(s-e)*g+f(),a+(x?0:f()),s+(x?0:f())]}):u.push({op:"bcurveTo",data:[y+t+(a-t)*g+m(),p+e+(s-e)*g+m(),y+t+2*(a-t)*g+m(),p+e+2*(s-e)*g+m(),a+(x?0:m()),s+(x?0:m())]}),u}function rt(t,e,a){if(!t.length)return[];const s=[];s.push([t[0][0]+at(e,a),t[0][1]+at(e,a)]),s.push([t[0][0]+at(e,a),t[0][1]+at(e,a)]);for(let n=1;n<t.length;n++)s.push([t[n][0]+at(e,a),t[n][1]+at(e,a)]),n===t.length-1&&s.push([t[n][0]+at(e,a),t[n][1]+at(e,a)]);return lt(s,null,a)}function lt(t,e,a){const s=t.length,n=[];if(s>3){const r=[],l=1-a.curveTightness;n.push({op:"move",data:[t[1][0],t[1][1]]});for(let e=1;e+2<s;e++){const a=t[e];r[0]=[a[0],a[1]],r[1]=[a[0]+(l*t[e+1][0]-l*t[e-1][0])/6,a[1]+(l*t[e+1][1]-l*t[e-1][1])/6],r[2]=[t[e+1][0]+(l*t[e][0]-l*t[e+2][0])/6,t[e+1][1]+(l*t[e][1]-l*t[e+2][1])/6],r[3]=[t[e+1][0],t[e+1][1]],n.push({op:"bcurveTo",data:[r[1][0],r[1][1],r[2][0],r[2][1],r[3][0],r[3][1]]})}if(e&&2===e.length){const t=a.maxRandomnessOffset;n.push({op:"lineTo",data:[e[0]+at(t,a),e[1]+at(t,a)]})}}else 3===s?(n.push({op:"move",data:[t[1][0],t[1][1]]}),n.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):2===s&&n.push(...nt(t[0][0],t[0][1],t[1][0],t[1][1],a,!0,!0));return n}function it(t,e,a,s,n,r,l,i){const o=[],h=[];if(0===i.roughness){t/=4,h.push([e+s*Math.cos(-t),a+n*Math.sin(-t)]);for(let r=0;r<=2*Math.PI;r+=t){const t=[e+s*Math.cos(r),a+n*Math.sin(r)];o.push(t),h.push(t)}h.push([e+s*Math.cos(0),a+n*Math.sin(0)]),h.push([e+s*Math.cos(t),a+n*Math.sin(t)])}else{const c=at(.5,i)-Math.PI/2;h.push([at(r,i)+e+.9*s*Math.cos(c-t),at(r,i)+a+.9*n*Math.sin(c-t)]);const d=2*Math.PI+c-.01;for(let l=c;l<d;l+=t){const t=[at(r,i)+e+s*Math.cos(l),at(r,i)+a+n*Math.sin(l)];o.push(t),h.push(t)}h.push([at(r,i)+e+s*Math.cos(c+2*Math.PI+.5*l),at(r,i)+a+n*Math.sin(c+2*Math.PI+.5*l)]),h.push([at(r,i)+e+.98*s*Math.cos(c+l),at(r,i)+a+.98*n*Math.sin(c+l)]),h.push([at(r,i)+e+.9*s*Math.cos(c+.5*l),at(r,i)+a+.9*n*Math.sin(c+.5*l)])}return[h,o]}function ot(t,e,a,s,n,r,l,i,o){const h=r+at(.1,o),c=[];c.push([at(i,o)+e+.9*s*Math.cos(h-t),at(i,o)+a+.9*n*Math.sin(h-t)]);for(let d=h;d<=l;d+=t)c.push([at(i,o)+e+s*Math.cos(d),at(i,o)+a+n*Math.sin(d)]);return c.push([e+s*Math.cos(l),a+n*Math.sin(l)]),c.push([e+s*Math.cos(l),a+n*Math.sin(l)]),lt(c,null,o)}function ht(t,e,a,s,n,r,l,i){const o=[],h=[i.maxRandomnessOffset||1,(i.maxRandomnessOffset||1)+.3];let c=[0,0];const d=i.disableMultiStroke?1:2,g=i.preserveVertices;for(let y=0;y<d;y++)0===y?o.push({op:"move",data:[l[0],l[1]]}):o.push({op:"move",data:[l[0]+(g?0:at(h[0],i)),l[1]+(g?0:at(h[0],i))]}),c=g?[n,r]:[n+at(h[y],i),r+at(h[y],i)],o.push({op:"bcurveTo",data:[t+at(h[y],i),e+at(h[y],i),a+at(h[y],i),s+at(h[y],i),c[0],c[1]]});return o}function ct(t){return[...t]}function dt(t,e=0){const a=t.length;if(a<3)throw new Error("A curve must have at least three points.");const s=[];if(3===a)s.push(ct(t[0]),ct(t[1]),ct(t[2]),ct(t[2]));else{const a=[];a.push(t[0],t[0]);for(let e=1;e<t.length;e++)a.push(t[e]),e===t.length-1&&a.push(t[e]);const n=[],r=1-e;s.push(ct(a[0]));for(let t=1;t+2<a.length;t++){const e=a[t];n[0]=[e[0],e[1]],n[1]=[e[0]+(r*a[t+1][0]-r*a[t-1][0])/6,e[1]+(r*a[t+1][1]-r*a[t-1][1])/6],n[2]=[a[t+1][0]+(r*a[t][0]-r*a[t+2][0])/6,a[t+1][1]+(r*a[t][1]-r*a[t+2][1])/6],n[3]=[a[t+1][0],a[t+1][1]],s.push(n[1],n[2],n[3])}}return s}function gt(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function yt(t,e,a){const s=gt(e,a);if(0===s)return gt(t,e);let n=((t[0]-e[0])*(a[0]-e[0])+(t[1]-e[1])*(a[1]-e[1]))/s;return n=Math.max(0,Math.min(1,n)),gt(t,pt(e,a,n))}function pt(t,e,a){return[t[0]+(e[0]-t[0])*a,t[1]+(e[1]-t[1])*a]}function ut(t,e,a,s){const n=s||[];if(function(t,e){const a=t[e+0],s=t[e+1],n=t[e+2],r=t[e+3];let l=3*s[0]-2*a[0]-r[0];l*=l;let i=3*s[1]-2*a[1]-r[1];i*=i;let o=3*n[0]-2*r[0]-a[0];o*=o;let h=3*n[1]-2*r[1]-a[1];return h*=h,l<o&&(l=o),i<h&&(i=h),l+i}(t,e)<a){const a=t[e+0];n.length?(r=n[n.length-1],l=a,Math.sqrt(gt(r,l))>1&&n.push(a)):n.push(a),n.push(t[e+3])}else{const s=.5,r=t[e+0],l=t[e+1],i=t[e+2],o=t[e+3],h=pt(r,l,s),c=pt(l,i,s),d=pt(i,o,s),g=pt(h,c,s),y=pt(c,d,s),p=pt(g,y,s);ut([r,h,g,p],0,a,n),ut([p,y,d,o],0,a,n)}var r,l;return n}function ft(t,e){return mt(t,0,t.length,e)}function mt(t,e,a,s,n){const r=n||[],l=t[e],i=t[a-1];let o=0,h=1;for(let c=e+1;c<a-1;++c){const e=yt(t[c],l,i);e>o&&(o=e,h=c)}return Math.sqrt(o)>s?(mt(t,e,h+1,s,r),mt(t,h,a,s,r)):(r.length||r.push(l),r.push(i)),r}function xt(t,e=.15,a){const s=[],n=(t.length-1)/3;for(let r=0;r<n;r++)ut(t,3*r,e,s);return a&&a>0?mt(s,0,s.length,a):s}var bt="none",wt=class{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,e,a){return{shape:t,sets:e||[],options:a||this.defaultOptions}}line(t,e,a,s,n){const r=this._o(n);return this._d("line",[V(t,e,a,s,r)],r)}rectangle(t,e,a,s,n){const r=this._o(n),l=[],i=function(t,e,a,s,n){return F([[t,e],[t+a,e],[t+a,e+s],[t,e+s]],!0,n)}(t,e,a,s,r);if(r.fill){const n=[[t,e],[t+a,e],[t+a,e+s],[t,e+s]];"solid"===r.fillStyle?l.push(J([n],r)):l.push(U([n],r))}return r.stroke!==bt&&l.push(i),this._d("rectangle",l,r)}ellipse(t,e,a,s,n){const r=this._o(n),l=[],i=Z(a,s,r),o=X(t,e,r,i);if(r.fill)if("solid"===r.fillStyle){const a=X(t,e,r,i).opset;a.type="fillPath",l.push(a)}else l.push(U([o.estimatedPoints],r));return r.stroke!==bt&&l.push(o.opset),this._d("ellipse",l,r)}circle(t,e,a,s){const n=this.ellipse(t,e,a,a,s);return n.shape="circle",n}linearPath(t,e){const a=this._o(e);return this._d("linearPath",[F(t,!1,a)],a)}arc(t,e,a,s,n,r,l=!1,i){const o=this._o(i),h=[],c=Y(t,e,a,s,n,r,l,!0,o);if(l&&o.fill)if("solid"===o.fillStyle){const l=Object.assign({},o);l.disableMultiStroke=!0;const i=Y(t,e,a,s,n,r,!0,!1,l);i.type="fillPath",h.push(i)}else h.push(function(t,e,a,s,n,r,l){const i=t,o=e;let h=Math.abs(a/2),c=Math.abs(s/2);h+=at(.01*h,l),c+=at(.01*c,l);let d=n,g=r;for(;d<0;)d+=2*Math.PI,g+=2*Math.PI;g-d>2*Math.PI&&(d=0,g=2*Math.PI);const y=(g-d)/l.curveStepCount,p=[];for(let u=d;u<=g;u+=y)p.push([i+h*Math.cos(u),o+c*Math.sin(u)]);return p.push([i+h*Math.cos(g),o+c*Math.sin(g)]),p.push([i,o]),U([p],l)}(t,e,a,s,n,r,o));return o.stroke!==bt&&h.push(c),this._d("arc",h,o)}curve(t,e){const a=this._o(e),s=[],n=G(t,a);if(a.fill&&a.fill!==bt)if("solid"===a.fillStyle){const e=G(t,Object.assign(Object.assign({},a),{disableMultiStroke:!0,roughness:a.roughness?a.roughness+a.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(e.ops)})}else{const e=[],n=t;if(n.length){const t="number"==typeof n[0][0]?[n]:n;for(const s of t)s.length<3?e.push(...s):3===s.length?e.push(...xt(dt([s[0],s[0],s[1],s[2]]),10,(1+a.roughness)/2)):e.push(...xt(dt(s),10,(1+a.roughness)/2))}e.length&&s.push(U([e],a))}return a.stroke!==bt&&s.push(n),this._d("curve",s,a)}polygon(t,e){const a=this._o(e),s=[],n=F(t,!0,a);return a.fill&&("solid"===a.fillStyle?s.push(J([t],a)):s.push(U([t],a))),a.stroke!==bt&&s.push(n),this._d("polygon",s,a)}path(t,e){const a=this._o(e),s=[];if(!t)return this._d("path",s,a);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const n=a.fill&&"transparent"!==a.fill&&a.fill!==bt,r=a.stroke!==bt,l=!!(a.simplification&&a.simplification<1),i=function(t,e,a){const s=j(_(E(t))),n=[];let r=[],l=[0,0],i=[];const o=()=>{i.length>=4&&r.push(...xt(i,1)),i=[]},h=()=>{o(),r.length&&(n.push(r),r=[])};for(const{key:d,data:g}of s)switch(d){case"M":h(),l=[g[0],g[1]],r.push(l);break;case"L":o(),r.push([g[0],g[1]]);break;case"C":if(!i.length){const t=r.length?r[r.length-1]:l;i.push([t[0],t[1]])}i.push([g[0],g[1]]),i.push([g[2],g[3]]),i.push([g[4],g[5]]);break;case"Z":o(),r.push([l[0],l[1]])}if(h(),!a)return n;const c=[];for(const d of n){const t=ft(d,a);t.length&&c.push(t)}return c}(t,0,l?4-4*(a.simplification||1):(1+a.roughness)/2),o=Q(t,a);if(n)if("solid"===a.fillStyle)if(1===i.length){const e=Q(t,Object.assign(Object.assign({},a),{disableMultiStroke:!0,roughness:a.roughness?a.roughness+a.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(e.ops)})}else s.push(J(i,a));else s.push(U(i,a));return r&&(l?i.forEach(t=>{s.push(F(t,!1,a))}):s.push(o)),this._d("path",s,a)}opsToPath(t,e){let a="";for(const s of t.ops){const t="number"==typeof e&&e>=0?s.data.map(t=>+t.toFixed(e)):s.data;switch(s.op){case"move":a+=`M${t[0]} ${t[1]} `;break;case"bcurveTo":a+=`C${t[0]} ${t[1]}, ${t[2]} ${t[3]}, ${t[4]} ${t[5]} `;break;case"lineTo":a+=`L${t[0]} ${t[1]} `}}return a.trim()}toPaths(t){const e=t.sets||[],a=t.options||this.defaultOptions,s=[];for(const n of e){let t=null;switch(n.type){case"path":t={d:this.opsToPath(n),stroke:a.stroke,strokeWidth:a.strokeWidth,fill:bt};break;case"fillPath":t={d:this.opsToPath(n),stroke:bt,strokeWidth:0,fill:a.fill||bt};break;case"fillSketch":t=this.fillSketch(n,a)}t&&s.push(t)}return s}fillSketch(t,e){let a=e.fillWeight;return a<0&&(a=e.strokeWidth/2),{d:this.opsToPath(t),stroke:e.fill||bt,strokeWidth:a,fill:bt}}_mergedShape(t){return t.filter((t,e)=>0===e||"move"!==t.op)}},St=class{constructor(t,e){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new wt(e)}draw(t){const e=t.sets||[],a=t.options||this.getDefaultOptions(),s=this.ctx,n=t.options.fixedDecimalPlaceDigits;for(const r of e)switch(r.type){case"path":s.save(),s.strokeStyle="none"===a.stroke?"transparent":a.stroke,s.lineWidth=a.strokeWidth,a.strokeLineDash&&s.setLineDash(a.strokeLineDash),a.strokeLineDashOffset&&(s.lineDashOffset=a.strokeLineDashOffset),this._drawToContext(s,r,n),s.restore();break;case"fillPath":{s.save(),s.fillStyle=a.fill||"";const e="curve"===t.shape||"polygon"===t.shape||"path"===t.shape?"evenodd":"nonzero";this._drawToContext(s,r,n,e),s.restore();break}case"fillSketch":this.fillSketch(s,r,a)}}fillSketch(t,e,a){let s=a.fillWeight;s<0&&(s=a.strokeWidth/2),t.save(),a.fillLineDash&&t.setLineDash(a.fillLineDash),a.fillLineDashOffset&&(t.lineDashOffset=a.fillLineDashOffset),t.strokeStyle=a.fill||"",t.lineWidth=s,this._drawToContext(t,e,a.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,e,a,s="nonzero"){t.beginPath();for(const n of e.ops){const e="number"==typeof a&&a>=0?n.data.map(t=>+t.toFixed(a)):n.data;switch(n.op){case"move":t.moveTo(e[0],e[1]);break;case"bcurveTo":t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5]);break;case"lineTo":t.lineTo(e[0],e[1])}}"fillPath"===e.type?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,e,a,s,n){const r=this.gen.line(t,e,a,s,n);return this.draw(r),r}rectangle(t,e,a,s,n){const r=this.gen.rectangle(t,e,a,s,n);return this.draw(r),r}ellipse(t,e,a,s,n){const r=this.gen.ellipse(t,e,a,s,n);return this.draw(r),r}circle(t,e,a,s){const n=this.gen.circle(t,e,a,s);return this.draw(n),n}linearPath(t,e){const a=this.gen.linearPath(t,e);return this.draw(a),a}polygon(t,e){const a=this.gen.polygon(t,e);return this.draw(a),a}arc(t,e,a,s,n,r,l=!1,i){const o=this.gen.arc(t,e,a,s,n,r,l,i);return this.draw(o),o}curve(t,e){const a=this.gen.curve(t,e);return this.draw(a),a}path(t,e){const a=this.gen.path(t,e);return this.draw(a),a}},kt="http://www.w3.org/2000/svg",$t=class{constructor(t,e){this.svg=t,this.gen=new wt(e)}draw(t){const e=t.sets||[],a=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,n=s.createElementNS(kt,"g"),r=t.options.fixedDecimalPlaceDigits;for(const l of e){let e=null;switch(l.type){case"path":e=s.createElementNS(kt,"path"),e.setAttribute("d",this.opsToPath(l,r)),e.setAttribute("stroke",a.stroke),e.setAttribute("stroke-width",a.strokeWidth+""),e.setAttribute("fill","none"),a.strokeLineDash&&e.setAttribute("stroke-dasharray",a.strokeLineDash.join(" ").trim()),a.strokeLineDashOffset&&e.setAttribute("stroke-dashoffset",`${a.strokeLineDashOffset}`);break;case"fillPath":e=s.createElementNS(kt,"path"),e.setAttribute("d",this.opsToPath(l,r)),e.setAttribute("stroke","none"),e.setAttribute("stroke-width","0"),e.setAttribute("fill",a.fill||""),"curve"!==t.shape&&"polygon"!==t.shape||e.setAttribute("fill-rule","evenodd");break;case"fillSketch":e=this.fillSketch(s,l,a)}e&&n.appendChild(e)}return n}fillSketch(t,e,a){let s=a.fillWeight;s<0&&(s=a.strokeWidth/2);const n=t.createElementNS(kt,"path");return n.setAttribute("d",this.opsToPath(e,a.fixedDecimalPlaceDigits)),n.setAttribute("stroke",a.fill||""),n.setAttribute("stroke-width",s+""),n.setAttribute("fill","none"),a.fillLineDash&&n.setAttribute("stroke-dasharray",a.fillLineDash.join(" ").trim()),a.fillLineDashOffset&&n.setAttribute("stroke-dashoffset",`${a.fillLineDashOffset}`),n}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,e){return this.gen.opsToPath(t,e)}line(t,e,a,s,n){const r=this.gen.line(t,e,a,s,n);return this.draw(r)}rectangle(t,e,a,s,n){const r=this.gen.rectangle(t,e,a,s,n);return this.draw(r)}ellipse(t,e,a,s,n){const r=this.gen.ellipse(t,e,a,s,n);return this.draw(r)}circle(t,e,a,s){const n=this.gen.circle(t,e,a,s);return this.draw(n)}linearPath(t,e){const a=this.gen.linearPath(t,e);return this.draw(a)}polygon(t,e){const a=this.gen.polygon(t,e);return this.draw(a)}arc(t,e,a,s,n,r,l=!1,i){const o=this.gen.arc(t,e,a,s,n,r,l,i);return this.draw(o)}curve(t,e){const a=this.gen.curve(t,e);return this.draw(a)}path(t,e){const a=this.gen.path(t,e);return this.draw(a)}},Mt={canvas:(t,e)=>new St(t,e),svg:(t,e)=>new $t(t,e),generator:t=>new wt(t),newSeed:()=>wt.newSeed()},vt=r(async(a,n,i)=>{let h;const c=n.useHtmlLabels||p(g()?.htmlLabels);h=i||"node default";const d=a.insert("g").attr("class",h).attr("id",n.domId||n.id),u=d.insert("g").attr("class","label").attr("style",s(n.labelStyle));let f;f=void 0===n.label?"":"string"==typeof n.label?n.label:n.label[0];const x=await m(u,o(t(f),g()),{useHtmlLabels:c,width:n.width||g().flowchart?.wrappingWidth,cssClasses:"markdown-node-label",style:n.labelStyle,addSvgBackground:!!n.icon||!!n.img});let b=x.getBBox();const w=(n?.padding??0)/2;if(c){const t=x.children[0],a=l(x),s=t.getElementsByTagName("img");if(s){const t=""===f.replace(/<img[^>]*>/g,"").trim();await Promise.all([...s].map(a=>new Promise(s=>{function n(){if(a.style.display="flex",a.style.flexDirection="column",t){const t=g().fontSize?g().fontSize:window.getComputedStyle(document.body).fontSize,s=5,[n=y.fontSize]=e(t),r=n*s+"px";a.style.minWidth=r,a.style.maxWidth=r}else a.style.width="100%";s(a)}r(n,"setupImage"),setTimeout(()=>{a.complete&&n()}),a.addEventListener("error",n),a.addEventListener("load",n)})))}b=t.getBoundingClientRect(),a.attr("width",b.width),a.attr("height",b.height)}return c?u.attr("transform","translate("+-b.width/2+", "+-b.height/2+")"):u.attr("transform","translate(0, "+-b.height/2+")"),n.centerLabel&&u.attr("transform","translate("+-b.width/2+", "+-b.height/2+")"),u.insert("rect",":first-child"),{shapeSvg:d,bbox:b,halfPadding:w,label:u}},"labelHelper"),Dt=r(async(e,a,s)=>{const n=s.useHtmlLabels||p(g()?.flowchart?.htmlLabels),r=e.insert("g").attr("class","label").attr("style",s.labelStyle||""),i=await m(r,o(t(a),g()),{useHtmlLabels:n,width:s.width||g()?.flowchart?.wrappingWidth,style:s.labelStyle,addSvgBackground:!!s.icon||!!s.img});let h=i.getBBox();const c=s.padding/2;if(p(g()?.flowchart?.htmlLabels)){const t=i.children[0],e=l(i);h=t.getBoundingClientRect(),e.attr("width",h.width),e.attr("height",h.height)}return n?r.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"):r.attr("transform","translate(0, "+-h.height/2+")"),s.centerLabel&&r.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"),r.insert("rect",":first-child"),{shapeSvg:e,bbox:h,halfPadding:c,label:r}},"insertLabel"),Ct=r((t,e)=>{const a=e.node().getBBox();t.width=a.width,t.height=a.height},"updateNodeBounds"),Pt=r((t,e)=>("handDrawn"===t.look?"rough-node":"node")+" "+t.cssClasses+" "+(e||""),"getNodeClasses");function Bt(t){const e=t.map((t,e)=>`${0===e?"M":"L"}${t.x},${t.y}`);return e.push("Z"),e.join(" ")}function At(t,e,a,s,n,r){const l=[],i=a-t,o=s-e,h=i/r,c=2*Math.PI/h,d=e+o/2;for(let g=0;g<=50;g++){const e=t+g/50*i,a=d+n*Math.sin(c*(e-t));l.push({x:e,y:a})}return l}function Lt(t,e,a,s,n,r){const l=[],i=n*Math.PI/180,o=(r*Math.PI/180-i)/(s-1);for(let h=0;h<s;h++){const s=i+h*o,n=t+a*Math.cos(s),r=e+a*Math.sin(s);l.push({x:-n,y:-r})}return l}r(Bt,"createPathFromPoints"),r(At,"generateFullSineWavePoints"),r(Lt,"generateCirclePoints");var Nt=r((t,e)=>{var a,s,n=t.x,r=t.y,l=e.x-n,i=e.y-r,o=t.width/2,h=t.height/2;return Math.abs(i)*o>Math.abs(l)*h?(i<0&&(h=-h),a=0===i?0:h*l/i,s=h):(l<0&&(o=-o),a=o,s=0===l?0:o*i/l),{x:n+a,y:r+s}},"intersectRect");function Rt(t,e){e&&t.attr("style",e)}async function Tt(t){const e=l(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),a=e.append("xhtml:div"),s=g();let n=t.label;t.label&&d(t.label)&&(n=await c(t.label.replace(u.lineBreakRegex,"\n"),s));const r='<span class="'+(t.isNode?"nodeLabel":"edgeLabel")+'" '+(t.labelStyle?'style="'+t.labelStyle+'"':"")+">"+n+"</span>";return a.html(o(r,s)),Rt(a,t.labelStyle),a.style("display","inline-block"),a.style("padding-right","1px"),a.style("white-space","nowrap"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),e.node()}r(Rt,"applyStyle"),r(Tt,"addHtmlLabel");var It=r(async(e,a,s,r)=>{let l=e||"";if("object"==typeof l&&(l=l[0]),p(g().flowchart.htmlLabels))return l=l.replace(/\\n|\n/g,"<br />"),n.info("vertexText"+l),await Tt({isNode:r,label:t(l).replace(/fa[blrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`),labelStyle:a?a.replace("fill:","color:"):a});{const t=document.createElementNS("http://www.w3.org/2000/svg","text");t.setAttribute("style",a.replace("color:","fill:"));let e=[];e="string"==typeof l?l.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(l)?l:[];for(const a of e){const e=document.createElementNS("http://www.w3.org/2000/svg","tspan");e.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),e.setAttribute("dy","1em"),e.setAttribute("x","0"),s?e.setAttribute("class","title-row"):e.setAttribute("class","row"),e.textContent=a.trim(),t.appendChild(e)}return t}},"createLabel"),Ot=r((t,e,a,s,n)=>["M",t+n,e,"H",t+a-n,"A",n,n,0,0,1,t+a,e+n,"V",e+s-n,"A",n,n,0,0,1,t+a-n,e+s,"H",t+n,"A",n,n,0,0,1,t,e+s-n,"V",e+n,"A",n,n,0,0,1,t+n,e,"Z"].join(" "),"createRoundedRectPathD"),Wt=r(async(t,e)=>{n.info("Creating subgraph rect for ",e.id,e);const a=g(),{themeVariables:s,handDrawnSeed:r}=a,{clusterBkg:i,clusterBorder:o}=s,{labelStyles:h,nodeStyles:c,borderStyles:d,backgroundStyles:y}=S(e),u=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),f=p(a.flowchart.htmlLabels),x=u.insert("g").attr("class","cluster-label "),k=await m(x,e.label,{style:e.labelStyle,useHtmlLabels:f,isNode:!0});let $=k.getBBox();if(p(a.flowchart.htmlLabels)){const t=k.children[0],e=l(k);$=t.getBoundingClientRect(),e.attr("width",$.width),e.attr("height",$.height)}const M=e.width<=$.width+e.padding?$.width+e.padding:e.width;e.width<=$.width+e.padding?e.diff=(M-e.width)/2-e.padding:e.diff=-e.padding;const v=e.height,D=e.x-M/2,C=e.y-v/2;let P;if(n.trace("Data ",e,JSON.stringify(e)),"handDrawn"===e.look){const t=Mt.svg(u),a=w(e,{roughness:.7,fill:i,stroke:o,fillWeight:3,seed:r}),s=t.path(Ot(D,C,M,v,0),a);P=u.insert(()=>(n.debug("Rough node insert CXC",s),s),":first-child"),P.select("path:nth-child(2)").attr("style",d.join(";")),P.select("path").attr("style",y.join(";").replace("fill","stroke"))}else P=u.insert("rect",":first-child"),P.attr("style",c).attr("rx",e.rx).attr("ry",e.ry).attr("x",D).attr("y",C).attr("width",M).attr("height",v);const{subGraphTitleTopMargin:B}=b(a);if(x.attr("transform",`translate(${e.x-$.width/2}, ${e.y-e.height/2+B})`),h){const t=x.select("span");t&&t.attr("style",h)}const A=P.node().getBBox();return e.offsetX=0,e.width=A.width,e.height=A.height,e.offsetY=$.height-e.padding/2,e.intersect=function(t){return Nt(e,t)},{cluster:u,labelBBox:$}},"rect"),Et={rect:Wt,squareRect:Wt,roundedWithTitle:r(async(t,e)=>{const a=g(),{themeVariables:s,handDrawnSeed:n}=a,{altBackground:r,compositeBackground:i,compositeTitleBackground:o,nodeBorder:h}=s,c=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-id",e.id).attr("data-look",e.look),d=c.insert("g",":first-child"),y=c.insert("g").attr("class","cluster-label");let u=c.append("rect");const f=y.node().appendChild(await It(e.label,e.labelStyle,void 0,!0));let m=f.getBBox();if(p(a.flowchart.htmlLabels)){const t=f.children[0],e=l(f);m=t.getBoundingClientRect(),e.attr("width",m.width),e.attr("height",m.height)}const x=0*e.padding,b=x/2,w=(e.width<=m.width+e.padding?m.width+e.padding:e.width)+x;e.width<=m.width+e.padding?e.diff=(w-e.width)/2-e.padding:e.diff=-e.padding;const S=e.height+x,k=e.height+x-m.height-6,$=e.x-w/2,M=e.y-S/2;e.width=w;const v=e.y-e.height/2-b+m.height+2;let D;if("handDrawn"===e.look){const t=e.cssClasses.includes("statediagram-cluster-alt"),a=Mt.svg(c),s=e.rx||e.ry?a.path(Ot($,M,w,S,10),{roughness:.7,fill:o,fillStyle:"solid",stroke:h,seed:n}):a.rectangle($,M,w,S,{seed:n});D=c.insert(()=>s,":first-child");const l=a.rectangle($,v,w,k,{fill:t?r:i,fillStyle:t?"hachure":"solid",stroke:h,seed:n});D=c.insert(()=>s,":first-child"),u=c.insert(()=>l)}else D=d.insert("rect",":first-child"),D.attr("class","outer").attr("x",$).attr("y",M).attr("width",w).attr("height",S).attr("data-look",e.look),u.attr("class","inner").attr("x",$).attr("y",v).attr("width",w).attr("height",k);return y.attr("transform",`translate(${e.x-m.width/2}, ${M+1-(p(a.flowchart.htmlLabels)?0:3)})`),e.height=D.node().getBBox().height,e.offsetX=0,e.offsetY=m.height-e.padding/2,e.labelBBox=m,e.intersect=function(t){return Nt(e,t)},{cluster:c,labelBBox:m}},"roundedWithTitle"),noteGroup:r((t,e)=>{const a=t.insert("g").attr("class","note-cluster").attr("id",e.id),s=a.insert("rect",":first-child"),n=0*e.padding,r=n/2;s.attr("rx",e.rx).attr("ry",e.ry).attr("x",e.x-e.width/2-r).attr("y",e.y-e.height/2-r).attr("width",e.width+n).attr("height",e.height+n).attr("fill","none");const l=s.node().getBBox();return e.width=l.width,e.height=l.height,e.intersect=function(t){return Nt(e,t)},{cluster:a,labelBBox:{width:0,height:0}}},"noteGroup"),divider:r((t,e)=>{const{themeVariables:a,handDrawnSeed:s}=g(),{nodeBorder:n}=a,r=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-look",e.look),l=r.insert("g",":first-child"),i=0*e.padding,o=e.width+i;e.diff=-e.padding;const h=e.height+i,c=e.x-o/2,d=e.y-h/2;let y;if(e.width=o,"handDrawn"===e.look){const t=Mt.svg(r).rectangle(c,d,o,h,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:n,seed:s});y=r.insert(()=>t,":first-child")}else y=l.insert("rect",":first-child"),y.attr("class","divider").attr("x",c).attr("y",d).attr("width",o).attr("height",h).attr("data-look",e.look);return e.height=y.node().getBBox().height,e.offsetX=0,e.offsetY=0,e.intersect=function(t){return Nt(e,t)},{cluster:r,labelBBox:{}}},"divider"),kanbanSection:r(async(t,e)=>{n.info("Creating subgraph rect for ",e.id,e);const a=g(),{themeVariables:s,handDrawnSeed:r}=a,{clusterBkg:i,clusterBorder:o}=s,{labelStyles:h,nodeStyles:c,borderStyles:d,backgroundStyles:y}=S(e),u=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),f=p(a.flowchart.htmlLabels),x=u.insert("g").attr("class","cluster-label "),k=await m(x,e.label,{style:e.labelStyle,useHtmlLabels:f,isNode:!0,width:e.width});let $=k.getBBox();if(p(a.flowchart.htmlLabels)){const t=k.children[0],e=l(k);$=t.getBoundingClientRect(),e.attr("width",$.width),e.attr("height",$.height)}const M=e.width<=$.width+e.padding?$.width+e.padding:e.width;e.width<=$.width+e.padding?e.diff=(M-e.width)/2-e.padding:e.diff=-e.padding;const v=e.height,D=e.x-M/2,C=e.y-v/2;let P;if(n.trace("Data ",e,JSON.stringify(e)),"handDrawn"===e.look){const t=Mt.svg(u),a=w(e,{roughness:.7,fill:i,stroke:o,fillWeight:4,seed:r}),s=t.path(Ot(D,C,M,v,e.rx),a);P=u.insert(()=>(n.debug("Rough node insert CXC",s),s),":first-child"),P.select("path:nth-child(2)").attr("style",d.join(";")),P.select("path").attr("style",y.join(";").replace("fill","stroke"))}else P=u.insert("rect",":first-child"),P.attr("style",c).attr("rx",e.rx).attr("ry",e.ry).attr("x",D).attr("y",C).attr("width",M).attr("height",v);const{subGraphTitleTopMargin:B}=b(a);if(x.attr("transform",`translate(${e.x-$.width/2}, ${e.y-e.height/2+B})`),h){const t=x.select("span");t&&t.attr("style",h)}const A=P.node().getBBox();return e.offsetX=0,e.width=A.width,e.height=A.height,e.offsetY=$.height-e.padding/2,e.intersect=function(t){return Nt(e,t)},{cluster:u,labelBBox:$}},"kanbanSection")},_t=new Map,jt=r(async(t,e)=>{const a=await Et[e.shape||"rect"](t,e);return _t.set(e.id,a),a},"insertCluster"),Ht=r(()=>{_t=new Map},"clear");function zt(t,e){return t.intersect(e)}r(zt,"intersectNode");var qt=zt;function Vt(t,e,a,s){var n=t.x,r=t.y,l=n-s.x,i=r-s.y,o=Math.sqrt(e*e*i*i+a*a*l*l),h=Math.abs(e*a*l/o);s.x<n&&(h=-h);var c=Math.abs(e*a*i/o);return s.y<r&&(c=-c),{x:n+h,y:r+c}}r(Vt,"intersectEllipse");var Ft=Vt;function Gt(t,e,a){return Ft(t,e,e,a)}r(Gt,"intersectCircle");var Zt=Gt;function Xt(t,e,a,s){{const n=e.y-t.y,r=t.x-e.x,l=e.x*t.y-t.x*e.y,i=n*a.x+r*a.y+l,o=n*s.x+r*s.y+l,h=1e-6;if(0!==i&&0!==o&&Yt(i,o))return;const c=s.y-a.y,d=a.x-s.x,g=s.x*a.y-a.x*s.y,y=c*t.x+d*t.y+g,p=c*e.x+d*e.y+g;if(Math.abs(y)<h&&Math.abs(p)<h&&Yt(y,p))return;const u=n*d-c*r;if(0===u)return;const f=Math.abs(u/2);let m=r*g-d*l;const x=m<0?(m-f)/u:(m+f)/u;return m=c*l-n*g,{x:x,y:m<0?(m-f)/u:(m+f)/u}}}function Yt(t,e){return t*e>0}r(Xt,"intersectLine"),r(Yt,"sameSign");var Qt=Xt;function Jt(t,e,a){let s=t.x,n=t.y,r=[],l=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;"function"==typeof e.forEach?e.forEach(function(t){l=Math.min(l,t.x),i=Math.min(i,t.y)}):(l=Math.min(l,e.x),i=Math.min(i,e.y));let o=s-t.width/2-l,h=n-t.height/2-i;for(let c=0;c<e.length;c++){let s=e[c],n=e[c<e.length-1?c+1:0],l=Qt(t,a,{x:o+s.x,y:h+s.y},{x:o+n.x,y:h+n.y});l&&r.push(l)}return r.length?(r.length>1&&r.sort(function(t,e){let s=t.x-a.x,n=t.y-a.y,r=Math.sqrt(s*s+n*n),l=e.x-a.x,i=e.y-a.y,o=Math.sqrt(l*l+i*i);return r<o?-1:r===o?0:1}),r[0]):t}r(Jt,"intersectPolygon");var Ut={node:qt,circle:Zt,ellipse:Ft,polygon:Jt,rect:Nt};function Kt(t,e){const{labelStyles:a}=S(e);e.labelStyle=a;const r=Pt(e);let l=r;r||(l="anchor");const i=t.insert("g").attr("class",l).attr("id",e.domId||e.id),{cssStyles:o}=e,h=Mt.svg(i),c=w(e,{fill:"black",stroke:"none",fillStyle:"solid"});"handDrawn"!==e.look&&(c.roughness=0);const d=h.circle(0,0,2,c),g=i.insert(()=>d,":first-child");return g.attr("class","anchor").attr("style",s(o)),Ct(e,g),e.intersect=function(t){return n.info("Circle intersect",e,1,t),Ut.circle(e,1,t)},i}function te(t,e,a,s,n,r,l){const i=(t+a)/2,o=(e+s)/2,h=Math.atan2(s-e,a-t),c=(a-t)/2/n,d=(s-e)/2/r,g=Math.sqrt(c**2+d**2);if(g>1)throw new Error("The given radii are too small to create an arc between the points.");const y=Math.sqrt(1-g**2),p=i+y*r*Math.sin(h)*(l?-1:1),u=o-y*n*Math.cos(h)*(l?-1:1),f=Math.atan2((e-u)/r,(t-p)/n);let m=Math.atan2((s-u)/r,(a-p)/n)-f;l&&m<0&&(m+=2*Math.PI),!l&&m>0&&(m-=2*Math.PI);const x=[];for(let b=0;b<20;b++){const t=f+b/19*m,e=p+n*Math.cos(t),a=u+r*Math.sin(t);x.push({x:e,y:a})}return x}async function ee(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=r.width+e.padding+20,i=r.height+e.padding,o=i/2,h=o/(2.5+i/50),{cssStyles:c}=e,d=[{x:l/2,y:-i/2},{x:-l/2,y:-i/2},...te(-l/2,-i/2,-l/2,i/2,h,o,!1),{x:l/2,y:i/2},...te(l/2,i/2,l/2,-i/2,h,o,!0)],g=Mt.svg(n),y=w(e,{});"handDrawn"!==e.look&&(y.roughness=0,y.fillStyle="solid");const p=Bt(d),u=g.path(p,y),f=n.insert(()=>u,":first-child");return f.attr("class","basic label-container"),c&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",c),s&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",s),f.attr("transform",`translate(${h/2}, 0)`),Ct(e,f),e.intersect=function(t){return Ut.polygon(e,d,t)},n}function ae(t,e,a,s){return t.insert("polygon",":first-child").attr("points",s.map(function(t){return t.x+","+t.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-e/2+","+a/2+")")}async function se(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=r.height+e.padding,i=r.width+e.padding+12,o=-l,h=[{x:12,y:o},{x:i,y:o},{x:i,y:0},{x:0,y:0},{x:0,y:o+12},{x:12,y:o}];let c;const{cssStyles:d}=e;if("handDrawn"===e.look){const t=Mt.svg(n),a=w(e,{}),s=Bt(h),r=t.path(s,a);c=n.insert(()=>r,":first-child").attr("transform",`translate(${-i/2}, ${l/2})`),d&&c.attr("style",d)}else c=ae(n,i,l,h);return s&&c.attr("style",s),Ct(e,c),e.intersect=function(t){return Ut.polygon(e,h,t)},n}function ne(t,e){const{nodeStyles:a}=S(e);e.label="";const s=t.insert("g").attr("class",Pt(e)).attr("id",e.domId??e.id),{cssStyles:n}=e,r=Math.max(28,e.width??0),l=[{x:0,y:r/2},{x:r/2,y:0},{x:0,y:-r/2},{x:-r/2,y:0}],i=Mt.svg(s),o=w(e,{});"handDrawn"!==e.look&&(o.roughness=0,o.fillStyle="solid");const h=Bt(l),c=i.path(h,o),d=s.insert(()=>c,":first-child");return n&&"handDrawn"!==e.look&&d.selectAll("path").attr("style",n),a&&"handDrawn"!==e.look&&d.selectAll("path").attr("style",a),e.width=28,e.height=28,e.intersect=function(t){return Ut.polygon(e,l,t)},s}async function re(t,e,a){const{labelStyles:r,nodeStyles:l}=S(e);e.labelStyle=r;const{shapeSvg:i,bbox:o,halfPadding:h}=await vt(t,e,Pt(e)),c=a?.padding??h,d=o.width/2+c;let g;const{cssStyles:y}=e;if("handDrawn"===e.look){const t=Mt.svg(i),a=w(e,{}),n=t.circle(0,0,2*d,a);g=i.insert(()=>n,":first-child"),g.attr("class","basic label-container").attr("style",s(y))}else g=i.insert("circle",":first-child").attr("class","basic label-container").attr("style",l).attr("r",d).attr("cx",0).attr("cy",0);return Ct(e,g),e.calcIntersect=function(t,e){const a=t.width/2;return Ut.circle(t,a,e)},e.intersect=function(t){return n.info("Circle intersect",e,d,t),Ut.circle(e,d,t)},i}function le(t){const e=Math.cos(Math.PI/4),a=Math.sin(Math.PI/4),s=2*t;return`M ${-s/2*e},${s/2*a} L ${s/2*e},${-s/2*a}\n                   M ${s/2*e},${s/2*a} L ${-s/2*e},${-s/2*a}`}function ie(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a,e.label="";const r=t.insert("g").attr("class",Pt(e)).attr("id",e.domId??e.id),l=Math.max(30,e?.width??0),{cssStyles:i}=e,o=Mt.svg(r),h=w(e,{});"handDrawn"!==e.look&&(h.roughness=0,h.fillStyle="solid");const c=o.circle(0,0,2*l,h),d=le(l),g=o.path(d,h),y=r.insert(()=>c,":first-child");return y.insert(()=>g),i&&"handDrawn"!==e.look&&y.selectAll("path").attr("style",i),s&&"handDrawn"!==e.look&&y.selectAll("path").attr("style",s),Ct(e,y),e.intersect=function(t){return n.info("crossedCircle intersect",e,{radius:l,point:t}),Ut.circle(e,l,t)},r}function oe(t,e,a,s=100,n=0,r=180){const l=[],i=n*Math.PI/180,o=(r*Math.PI/180-i)/(s-1);for(let h=0;h<s;h++){const s=i+h*o,n=t+a*Math.cos(s),r=e+a*Math.sin(s);l.push({x:-n,y:-r})}return l}async function he(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,label:l}=await vt(t,e,Pt(e)),i=r.width+(e.padding??0),o=r.height+(e.padding??0),h=Math.max(5,.1*o),{cssStyles:c}=e,d=[...oe(i/2,-o/2,h,30,-90,0),{x:-i/2-h,y:h},...oe(i/2+2*h,-h,h,20,-180,-270),...oe(i/2+2*h,h,h,20,-90,-180),{x:-i/2-h,y:-o/2},...oe(i/2,o/2,h,20,0,90)],g=[{x:i/2,y:-o/2-h},{x:-i/2,y:-o/2-h},...oe(i/2,-o/2,h,20,-90,0),{x:-i/2-h,y:-h},...oe(i/2+.1*i,-h,h,20,-180,-270),...oe(i/2+.1*i,h,h,20,-90,-180),{x:-i/2-h,y:o/2},...oe(i/2,o/2,h,20,0,90),{x:-i/2,y:o/2+h},{x:i/2,y:o/2+h}],y=Mt.svg(n),p=w(e,{fill:"none"});"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");const u=Bt(d).replace("Z",""),f=y.path(u,p),m=Bt(g),x=y.path(m,{...p}),b=n.insert("g",":first-child");return b.insert(()=>x,":first-child").attr("stroke-opacity",0),b.insert(()=>f,":first-child"),b.attr("class","text"),c&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",c),s&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",s),b.attr("transform",`translate(${h}, 0)`),l.attr("transform",`translate(${-i/2+h-(r.x-(r.left??0))},${-o/2+(e.padding??0)/2-(r.y-(r.top??0))})`),Ct(e,b),e.intersect=function(t){return Ut.polygon(e,g,t)},n}function ce(t,e,a,s=100,n=0,r=180){const l=[],i=n*Math.PI/180,o=(r*Math.PI/180-i)/(s-1);for(let h=0;h<s;h++){const s=i+h*o,n=t+a*Math.cos(s),r=e+a*Math.sin(s);l.push({x:n,y:r})}return l}async function de(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,label:l}=await vt(t,e,Pt(e)),i=r.width+(e.padding??0),o=r.height+(e.padding??0),h=Math.max(5,.1*o),{cssStyles:c}=e,d=[...ce(i/2,-o/2,h,20,-90,0),{x:i/2+h,y:-h},...ce(i/2+2*h,-h,h,20,-180,-270),...ce(i/2+2*h,h,h,20,-90,-180),{x:i/2+h,y:o/2},...ce(i/2,o/2,h,20,0,90)],g=[{x:-i/2,y:-o/2-h},{x:i/2,y:-o/2-h},...ce(i/2,-o/2,h,20,-90,0),{x:i/2+h,y:-h},...ce(i/2+2*h,-h,h,20,-180,-270),...ce(i/2+2*h,h,h,20,-90,-180),{x:i/2+h,y:o/2},...ce(i/2,o/2,h,20,0,90),{x:i/2,y:o/2+h},{x:-i/2,y:o/2+h}],y=Mt.svg(n),p=w(e,{fill:"none"});"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");const u=Bt(d).replace("Z",""),f=y.path(u,p),m=Bt(g),x=y.path(m,{...p}),b=n.insert("g",":first-child");return b.insert(()=>x,":first-child").attr("stroke-opacity",0),b.insert(()=>f,":first-child"),b.attr("class","text"),c&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",c),s&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",s),b.attr("transform",`translate(${-h}, 0)`),l.attr("transform",`translate(${-i/2+(e.padding??0)/2-(r.x-(r.left??0))},${-o/2+(e.padding??0)/2-(r.y-(r.top??0))})`),Ct(e,b),e.intersect=function(t){return Ut.polygon(e,g,t)},n}function ge(t,e,a,s=100,n=0,r=180){const l=[],i=n*Math.PI/180,o=(r*Math.PI/180-i)/(s-1);for(let h=0;h<s;h++){const s=i+h*o,n=t+a*Math.cos(s),r=e+a*Math.sin(s);l.push({x:-n,y:-r})}return l}async function ye(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,label:l}=await vt(t,e,Pt(e)),i=r.width+(e.padding??0),o=r.height+(e.padding??0),h=Math.max(5,.1*o),{cssStyles:c}=e,d=[...ge(i/2,-o/2,h,30,-90,0),{x:-i/2-h,y:h},...ge(i/2+2*h,-h,h,20,-180,-270),...ge(i/2+2*h,h,h,20,-90,-180),{x:-i/2-h,y:-o/2},...ge(i/2,o/2,h,20,0,90)],g=[...ge(-i/2+h+h/2,-o/2,h,20,-90,-180),{x:i/2-h/2,y:h},...ge(-i/2-h/2,-h,h,20,0,90),...ge(-i/2-h/2,h,h,20,-90,0),{x:i/2-h/2,y:-h},...ge(-i/2+h+h/2,o/2,h,30,-180,-270)],y=[{x:i/2,y:-o/2-h},{x:-i/2,y:-o/2-h},...ge(i/2,-o/2,h,20,-90,0),{x:-i/2-h,y:-h},...ge(i/2+2*h,-h,h,20,-180,-270),...ge(i/2+2*h,h,h,20,-90,-180),{x:-i/2-h,y:o/2},...ge(i/2,o/2,h,20,0,90),{x:-i/2,y:o/2+h},{x:i/2-h-h/2,y:o/2+h},...ge(-i/2+h+h/2,-o/2,h,20,-90,-180),{x:i/2-h/2,y:h},...ge(-i/2-h/2,-h,h,20,0,90),...ge(-i/2-h/2,h,h,20,-90,0),{x:i/2-h/2,y:-h},...ge(-i/2+h+h/2,o/2,h,30,-180,-270)],p=Mt.svg(n),u=w(e,{fill:"none"});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");const f=Bt(d).replace("Z",""),m=p.path(f,u),x=Bt(g).replace("Z",""),b=p.path(x,u),k=Bt(y),$=p.path(k,{...u}),M=n.insert("g",":first-child");return M.insert(()=>$,":first-child").attr("stroke-opacity",0),M.insert(()=>m,":first-child"),M.insert(()=>b,":first-child"),M.attr("class","text"),c&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",c),s&&"handDrawn"!==e.look&&M.selectAll("path").attr("style",s),M.attr("transform",`translate(${h-h/4}, 0)`),l.attr("transform",`translate(${-i/2+(e.padding??0)/2-(r.x-(r.left??0))},${-o/2+(e.padding??0)/2-(r.y-(r.top??0))})`),Ct(e,M),e.intersect=function(t){return Ut.polygon(e,y,t)},n}async function pe(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=Math.max(80,1.25*(r.width+2*(e.padding??0)),e?.width??0),i=Math.max(20,r.height+2*(e.padding??0),e?.height??0),o=i/2,{cssStyles:h}=e,c=Mt.svg(n),d=w(e,{});"handDrawn"!==e.look&&(d.roughness=0,d.fillStyle="solid");const g=l-o,y=i/4,p=[{x:g,y:0},{x:y,y:0},{x:0,y:i/2},{x:y,y:i},{x:g,y:i},...Lt(-g,-i/2,o,50,270,90)],u=Bt(p),f=c.path(u,d),m=n.insert(()=>f,":first-child");return m.attr("class","basic label-container"),h&&"handDrawn"!==e.look&&m.selectChildren("path").attr("style",h),s&&"handDrawn"!==e.look&&m.selectChildren("path").attr("style",s),m.attr("transform",`translate(${-l/2}, ${-i/2})`),Ct(e,m),e.intersect=function(t){return Ut.polygon(e,p,t)},n}r(Kt,"anchor"),r(te,"generateArcPoints"),r(ee,"bowTieRect"),r(ae,"insertPolygonShape"),r(se,"card"),r(ne,"choice"),r(re,"circle"),r(le,"createLine"),r(ie,"crossedCircle"),r(oe,"generateCirclePoints"),r(he,"curlyBraceLeft"),r(ce,"generateCirclePoints"),r(de,"curlyBraceRight"),r(ge,"generateCirclePoints"),r(ye,"curlyBraces"),r(pe,"curvedTrapezoid");var ue=r((t,e,a,s,n,r)=>[`M${t},${e+r}`,`a${n},${r} 0,0,0 ${a},0`,`a${n},${r} 0,0,0 ${-a},0`,`l0,${s}`,`a${n},${r} 0,0,0 ${a},0`,"l0,"+-s].join(" "),"createCylinderPathD"),fe=r((t,e,a,s,n,r)=>[`M${t},${e+r}`,`M${t+a},${e+r}`,`a${n},${r} 0,0,0 ${-a},0`,`l0,${s}`,`a${n},${r} 0,0,0 ${a},0`,"l0,"+-s].join(" "),"createOuterCylinderPathD"),me=r((t,e,a,s,n,r)=>[`M${t-a/2},${-s/2}`,`a${n},${r} 0,0,0 ${a},0`].join(" "),"createInnerCylinderPathD");async function xe(t,e){const{labelStyles:a,nodeStyles:n}=S(e);e.labelStyle=a;const{shapeSvg:r,bbox:l,label:i}=await vt(t,e,Pt(e)),o=Math.max(l.width+e.padding,e.width??0),h=o/2,c=h/(2.5+o/50),d=Math.max(l.height+c+e.padding,e.height??0);let g;const{cssStyles:y}=e;if("handDrawn"===e.look){const t=Mt.svg(r),a=fe(0,0,o,d,h,c),s=me(0,c,o,d,h,c),n=t.path(a,w(e,{})),l=t.path(s,w(e,{fill:"none"}));g=r.insert(()=>l,":first-child"),g=r.insert(()=>n,":first-child"),g.attr("class","basic label-container"),y&&g.attr("style",y)}else{const t=ue(0,0,o,d,h,c);g=r.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",s(y)).attr("style",n)}return g.attr("label-offset-y",c),g.attr("transform",`translate(${-o/2}, ${-(d/2+c)})`),Ct(e,g),i.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))}, ${-l.height/2+(e.padding??0)/1.5-(l.y-(l.top??0))})`),e.intersect=function(t){const a=Ut.rect(e,t),s=a.x-(e.x??0);if(0!=h&&(Math.abs(s)<(e.width??0)/2||Math.abs(s)==(e.width??0)/2&&Math.abs(a.y-(e.y??0))>(e.height??0)/2-c)){let n=c*c*(1-s*s/(h*h));n>0&&(n=Math.sqrt(n)),n=c-n,t.y-(e.y??0)>0&&(n=-n),a.y+=n}return a},r}async function be(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,label:l}=await vt(t,e,Pt(e)),i=r.width+e.padding,o=r.height+e.padding,h=.2*o,c=-i/2,d=-o/2-h/2,{cssStyles:g}=e,y=Mt.svg(n),p=w(e,{});"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");const u=[{x:c,y:d+h},{x:-c,y:d+h},{x:-c,y:-d},{x:c,y:-d},{x:c,y:d},{x:-c,y:d},{x:-c,y:d+h}],f=y.polygon(u.map(t=>[t.x,t.y]),p),m=n.insert(()=>f,":first-child");return m.attr("class","basic label-container"),g&&"handDrawn"!==e.look&&m.selectAll("path").attr("style",g),s&&"handDrawn"!==e.look&&m.selectAll("path").attr("style",s),l.attr("transform",`translate(${c+(e.padding??0)/2-(r.x-(r.left??0))}, ${d+h+(e.padding??0)/2-(r.y-(r.top??0))})`),Ct(e,m),e.intersect=function(t){return Ut.rect(e,t)},n}async function we(t,e){const{labelStyles:a,nodeStyles:r}=S(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,halfPadding:o}=await vt(t,e,Pt(e)),h=i.width/2+o+5,c=i.width/2+o;let d;const{cssStyles:g}=e;if("handDrawn"===e.look){const t=Mt.svg(l),a=w(e,{roughness:.2,strokeWidth:2.5}),n=w(e,{roughness:.2,strokeWidth:1.5}),r=t.circle(0,0,2*h,a),i=t.circle(0,0,2*c,n);d=l.insert("g",":first-child"),d.attr("class",s(e.cssClasses)).attr("style",s(g)),d.node()?.appendChild(r),d.node()?.appendChild(i)}else{d=l.insert("g",":first-child");const t=d.insert("circle",":first-child"),e=d.insert("circle");d.attr("class","basic label-container").attr("style",r),t.attr("class","outer-circle").attr("style",r).attr("r",h).attr("cx",0).attr("cy",0),e.attr("class","inner-circle").attr("style",r).attr("r",c).attr("cx",0).attr("cy",0)}return Ct(e,d),e.intersect=function(t){return n.info("DoubleCircle intersect",e,h,t),Ut.circle(e,h,t)},l}function Se(t,e,{config:{themeVariables:a}}){const{labelStyles:s,nodeStyles:r}=S(e);e.label="",e.labelStyle=s;const l=t.insert("g").attr("class",Pt(e)).attr("id",e.domId??e.id),{cssStyles:i}=e,o=Mt.svg(l),{nodeBorder:h}=a,c=w(e,{fillStyle:"solid"});"handDrawn"!==e.look&&(c.roughness=0);const d=o.circle(0,0,14,c),g=l.insert(()=>d,":first-child");return g.selectAll("path").attr("style",`fill: ${h} !important;`),i&&i.length>0&&"handDrawn"!==e.look&&g.selectAll("path").attr("style",i),r&&"handDrawn"!==e.look&&g.selectAll("path").attr("style",r),Ct(e,g),e.intersect=function(t){return n.info("filledCircle intersect",e,{radius:7,point:t}),Ut.circle(e,7,t)},l}async function ke(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:r,bbox:l,label:i}=await vt(t,e,Pt(e)),o=l.width+(e.padding??0),h=o+l.height,c=o+l.height,d=[{x:0,y:-h},{x:c,y:-h},{x:c/2,y:0}],{cssStyles:g}=e,y=Mt.svg(r),p=w(e,{});"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");const u=Bt(d),f=y.path(u,p),m=r.insert(()=>f,":first-child").attr("transform",`translate(${-h/2}, ${h/2})`);return g&&"handDrawn"!==e.look&&m.selectChildren("path").attr("style",g),s&&"handDrawn"!==e.look&&m.selectChildren("path").attr("style",s),e.width=o,e.height=h,Ct(e,m),i.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))}, ${-h/2+(e.padding??0)/2+(l.y-(l.top??0))})`),e.intersect=function(t){return n.info("Triangle intersect",e,d,t),Ut.polygon(e,d,t)},r}function $e(t,e,{dir:a,config:{state:s,themeVariables:n}}){const{nodeStyles:r}=S(e);e.label="";const l=t.insert("g").attr("class",Pt(e)).attr("id",e.domId??e.id),{cssStyles:i}=e;let o=Math.max(70,e?.width??0),h=Math.max(10,e?.height??0);"LR"===a&&(o=Math.max(10,e?.width??0),h=Math.max(70,e?.height??0));const c=-1*o/2,d=-1*h/2,g=Mt.svg(l),y=w(e,{stroke:n.lineColor,fill:n.lineColor});"handDrawn"!==e.look&&(y.roughness=0,y.fillStyle="solid");const p=g.rectangle(c,d,o,h,y),u=l.insert(()=>p,":first-child");i&&"handDrawn"!==e.look&&u.selectAll("path").attr("style",i),r&&"handDrawn"!==e.look&&u.selectAll("path").attr("style",r),Ct(e,u);const f=s?.padding??0;return e.width&&e.height&&(e.width+=f/2||0,e.height+=f/2||0),e.intersect=function(t){return Ut.rect(e,t)},l}async function Me(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:r,bbox:l}=await vt(t,e,Pt(e)),i=Math.max(80,l.width+2*(e.padding??0),e?.width??0),o=Math.max(50,l.height+2*(e.padding??0),e?.height??0),h=o/2,{cssStyles:c}=e,d=Mt.svg(r),g=w(e,{});"handDrawn"!==e.look&&(g.roughness=0,g.fillStyle="solid");const y=[{x:-i/2,y:-o/2},{x:i/2-h,y:-o/2},...Lt(-i/2+h,0,h,50,90,270),{x:i/2-h,y:o/2},{x:-i/2,y:o/2}],p=Bt(y),u=d.path(p,g),f=r.insert(()=>u,":first-child");return f.attr("class","basic label-container"),c&&"handDrawn"!==e.look&&f.selectChildren("path").attr("style",c),s&&"handDrawn"!==e.look&&f.selectChildren("path").attr("style",s),Ct(e,f),e.intersect=function(t){return n.info("Pill intersect",e,{radius:h,point:t}),Ut.polygon(e,y,t)},r}async function ve(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=r.height+(e.padding??0),i=r.width+2.5*(e.padding??0),{cssStyles:o}=e,h=Mt.svg(n),c=w(e,{});"handDrawn"!==e.look&&(c.roughness=0,c.fillStyle="solid");let d=i/2;d+=d/6;const g=l/2,y=d-g/2,p=[{x:-y,y:-g},{x:0,y:-g},{x:y,y:-g},{x:d,y:0},{x:y,y:g},{x:0,y:g},{x:-y,y:g},{x:-d,y:0}],u=Bt(p),f=h.path(u,c),m=n.insert(()=>f,":first-child");return m.attr("class","basic label-container"),o&&"handDrawn"!==e.look&&m.selectChildren("path").attr("style",o),s&&"handDrawn"!==e.look&&m.selectChildren("path").attr("style",s),e.width=i,e.height=l,Ct(e,m),e.intersect=function(t){return Ut.polygon(e,p,t)},n}async function De(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.label="",e.labelStyle=a;const{shapeSvg:r}=await vt(t,e,Pt(e)),l=Math.max(30,e?.width??0),i=Math.max(30,e?.height??0),{cssStyles:o}=e,h=Mt.svg(r),c=w(e,{});"handDrawn"!==e.look&&(c.roughness=0,c.fillStyle="solid");const d=[{x:0,y:0},{x:l,y:0},{x:0,y:i},{x:l,y:i}],g=Bt(d),y=h.path(g,c),p=r.insert(()=>y,":first-child");return p.attr("class","basic label-container"),o&&"handDrawn"!==e.look&&p.selectChildren("path").attr("style",o),s&&"handDrawn"!==e.look&&p.selectChildren("path").attr("style",s),p.attr("transform",`translate(${-l/2}, ${-i/2})`),Ct(e,p),e.intersect=function(t){return n.info("Pill intersect",e,{points:d}),Ut.polygon(e,d,t)},r}async function Ce(t,e,{config:{themeVariables:a,flowchart:s}}){const{labelStyles:r}=S(e);e.labelStyle=r;const l=e.assetHeight??48,i=e.assetWidth??48,o=Math.max(l,i),h=s?.wrappingWidth;e.width=Math.max(o,h??0);const{shapeSvg:c,bbox:d,label:g}=await vt(t,e,"icon-shape default"),y="t"===e.pos,p=o,u=o,{nodeBorder:f}=a,{stylesMap:m}=$(e),b=-u/2,k=-p/2,M=e.label?8:0,v=Mt.svg(c),D=w(e,{stroke:"none",fill:"none"});"handDrawn"!==e.look&&(D.roughness=0,D.fillStyle="solid");const C=v.rectangle(b,k,u,p,D),P=Math.max(u,d.width),B=p+d.height+M,A=v.rectangle(-P/2,-B/2,P,B,{...D,fill:"transparent",stroke:"none"}),L=c.insert(()=>C,":first-child"),N=c.insert(()=>A);if(e.icon){const t=c.append("g");t.html(`<g>${await x(e.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const a=t.node().getBBox(),s=a.width,n=a.height,r=a.x,l=a.y;t.attr("transform",`translate(${-s/2-r},${y?d.height/2+M/2-n/2-l:-d.height/2-M/2-n/2-l})`),t.attr("style",`color: ${m.get("stroke")??f};`)}return g.attr("transform",`translate(${-d.width/2-(d.x-(d.left??0))},${y?-B/2:B/2-d.height})`),L.attr("transform",`translate(0,${y?d.height/2+M/2:-d.height/2-M/2})`),Ct(e,N),e.intersect=function(t){if(n.info("iconSquare intersect",e,t),!e.label)return Ut.rect(e,t);const a=e.x??0,s=e.y??0,r=e.height??0;let l=[];return l=y?[{x:a-d.width/2,y:s-r/2},{x:a+d.width/2,y:s-r/2},{x:a+d.width/2,y:s-r/2+d.height+M},{x:a+u/2,y:s-r/2+d.height+M},{x:a+u/2,y:s+r/2},{x:a-u/2,y:s+r/2},{x:a-u/2,y:s-r/2+d.height+M},{x:a-d.width/2,y:s-r/2+d.height+M}]:[{x:a-u/2,y:s-r/2},{x:a+u/2,y:s-r/2},{x:a+u/2,y:s-r/2+p},{x:a+d.width/2,y:s-r/2+p},{x:a+d.width/2/2,y:s+r/2},{x:a-d.width/2,y:s+r/2},{x:a-d.width/2,y:s-r/2+p},{x:a-u/2,y:s-r/2+p}],Ut.polygon(e,l,t)},c}async function Pe(t,e,{config:{themeVariables:a,flowchart:s}}){const{labelStyles:r}=S(e);e.labelStyle=r;const l=e.assetHeight??48,i=e.assetWidth??48,o=Math.max(l,i),h=s?.wrappingWidth;e.width=Math.max(o,h??0);const{shapeSvg:c,bbox:d,label:g}=await vt(t,e,"icon-shape default"),y=e.label?8:0,p="t"===e.pos,{nodeBorder:u,mainBkg:f}=a,{stylesMap:m}=$(e),b=Mt.svg(c),k=w(e,{});"handDrawn"!==e.look&&(k.roughness=0,k.fillStyle="solid"),k.stroke=m.get("fill")??f;const M=c.append("g");e.icon&&M.html(`<g>${await x(e.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const v=M.node().getBBox(),D=v.width,C=v.height,P=v.x,B=v.y,A=Math.max(D,C)*Math.SQRT2+40,L=b.circle(0,0,A,k),N=Math.max(A,d.width),R=A+d.height+y,T=b.rectangle(-N/2,-R/2,N,R,{...k,fill:"transparent",stroke:"none"}),I=c.insert(()=>L,":first-child"),O=c.insert(()=>T);return M.attr("transform",`translate(${-D/2-P},${p?d.height/2+y/2-C/2-B:-d.height/2-y/2-C/2-B})`),M.attr("style",`color: ${m.get("stroke")??u};`),g.attr("transform",`translate(${-d.width/2-(d.x-(d.left??0))},${p?-R/2:R/2-d.height})`),I.attr("transform",`translate(0,${p?d.height/2+y/2:-d.height/2-y/2})`),Ct(e,O),e.intersect=function(t){return n.info("iconSquare intersect",e,t),Ut.rect(e,t)},c}async function Be(t,e,{config:{themeVariables:a,flowchart:s}}){const{labelStyles:r}=S(e);e.labelStyle=r;const l=e.assetHeight??48,i=e.assetWidth??48,o=Math.max(l,i),h=s?.wrappingWidth;e.width=Math.max(o,h??0);const{shapeSvg:c,bbox:d,halfPadding:g,label:y}=await vt(t,e,"icon-shape default"),p="t"===e.pos,u=o+2*g,f=o+2*g,{nodeBorder:m,mainBkg:b}=a,{stylesMap:k}=$(e),M=-f/2,v=-u/2,D=e.label?8:0,C=Mt.svg(c),P=w(e,{});"handDrawn"!==e.look&&(P.roughness=0,P.fillStyle="solid"),P.stroke=k.get("fill")??b;const B=C.path(Ot(M,v,f,u,5),P),A=Math.max(f,d.width),L=u+d.height+D,N=C.rectangle(-A/2,-L/2,A,L,{...P,fill:"transparent",stroke:"none"}),R=c.insert(()=>B,":first-child").attr("class","icon-shape2"),T=c.insert(()=>N);if(e.icon){const t=c.append("g");t.html(`<g>${await x(e.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const a=t.node().getBBox(),s=a.width,n=a.height,r=a.x,l=a.y;t.attr("transform",`translate(${-s/2-r},${p?d.height/2+D/2-n/2-l:-d.height/2-D/2-n/2-l})`),t.attr("style",`color: ${k.get("stroke")??m};`)}return y.attr("transform",`translate(${-d.width/2-(d.x-(d.left??0))},${p?-L/2:L/2-d.height})`),R.attr("transform",`translate(0,${p?d.height/2+D/2:-d.height/2-D/2})`),Ct(e,T),e.intersect=function(t){if(n.info("iconSquare intersect",e,t),!e.label)return Ut.rect(e,t);const a=e.x??0,s=e.y??0,r=e.height??0;let l=[];return l=p?[{x:a-d.width/2,y:s-r/2},{x:a+d.width/2,y:s-r/2},{x:a+d.width/2,y:s-r/2+d.height+D},{x:a+f/2,y:s-r/2+d.height+D},{x:a+f/2,y:s+r/2},{x:a-f/2,y:s+r/2},{x:a-f/2,y:s-r/2+d.height+D},{x:a-d.width/2,y:s-r/2+d.height+D}]:[{x:a-f/2,y:s-r/2},{x:a+f/2,y:s-r/2},{x:a+f/2,y:s-r/2+u},{x:a+d.width/2,y:s-r/2+u},{x:a+d.width/2/2,y:s+r/2},{x:a-d.width/2,y:s+r/2},{x:a-d.width/2,y:s-r/2+u},{x:a-f/2,y:s-r/2+u}],Ut.polygon(e,l,t)},c}async function Ae(t,e,{config:{themeVariables:a,flowchart:s}}){const{labelStyles:r}=S(e);e.labelStyle=r;const l=e.assetHeight??48,i=e.assetWidth??48,o=Math.max(l,i),h=s?.wrappingWidth;e.width=Math.max(o,h??0);const{shapeSvg:c,bbox:d,halfPadding:g,label:y}=await vt(t,e,"icon-shape default"),p="t"===e.pos,u=o+2*g,f=o+2*g,{nodeBorder:m,mainBkg:b}=a,{stylesMap:k}=$(e),M=-f/2,v=-u/2,D=e.label?8:0,C=Mt.svg(c),P=w(e,{});"handDrawn"!==e.look&&(P.roughness=0,P.fillStyle="solid"),P.stroke=k.get("fill")??b;const B=C.path(Ot(M,v,f,u,.1),P),A=Math.max(f,d.width),L=u+d.height+D,N=C.rectangle(-A/2,-L/2,A,L,{...P,fill:"transparent",stroke:"none"}),R=c.insert(()=>B,":first-child"),T=c.insert(()=>N);if(e.icon){const t=c.append("g");t.html(`<g>${await x(e.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const a=t.node().getBBox(),s=a.width,n=a.height,r=a.x,l=a.y;t.attr("transform",`translate(${-s/2-r},${p?d.height/2+D/2-n/2-l:-d.height/2-D/2-n/2-l})`),t.attr("style",`color: ${k.get("stroke")??m};`)}return y.attr("transform",`translate(${-d.width/2-(d.x-(d.left??0))},${p?-L/2:L/2-d.height})`),R.attr("transform",`translate(0,${p?d.height/2+D/2:-d.height/2-D/2})`),Ct(e,T),e.intersect=function(t){if(n.info("iconSquare intersect",e,t),!e.label)return Ut.rect(e,t);const a=e.x??0,s=e.y??0,r=e.height??0;let l=[];return l=p?[{x:a-d.width/2,y:s-r/2},{x:a+d.width/2,y:s-r/2},{x:a+d.width/2,y:s-r/2+d.height+D},{x:a+f/2,y:s-r/2+d.height+D},{x:a+f/2,y:s+r/2},{x:a-f/2,y:s+r/2},{x:a-f/2,y:s-r/2+d.height+D},{x:a-d.width/2,y:s-r/2+d.height+D}]:[{x:a-f/2,y:s-r/2},{x:a+f/2,y:s-r/2},{x:a+f/2,y:s-r/2+u},{x:a+d.width/2,y:s-r/2+u},{x:a+d.width/2/2,y:s+r/2},{x:a-d.width/2,y:s+r/2},{x:a-d.width/2,y:s-r/2+u},{x:a-f/2,y:s-r/2+u}],Ut.polygon(e,l,t)},c}async function Le(t,e,{config:{flowchart:a}}){const s=new Image;s.src=e?.img??"",await s.decode();const r=Number(s.naturalWidth.toString().replace("px","")),l=Number(s.naturalHeight.toString().replace("px",""));e.imageAspectRatio=r/l;const{labelStyles:i}=S(e);e.labelStyle=i;const o=a?.wrappingWidth;e.defaultWidth=a?.wrappingWidth;const h=Math.max(e.label?o??0:0,e?.assetWidth??r),c="on"===e.constraint&&e?.assetHeight?e.assetHeight*e.imageAspectRatio:h,d="on"===e.constraint?c/e.imageAspectRatio:e?.assetHeight??l;e.width=Math.max(c,o??0);const{shapeSvg:g,bbox:y,label:p}=await vt(t,e,"image-shape default"),u="t"===e.pos,f=-c/2,m=-d/2,x=e.label?8:0,b=Mt.svg(g),k=w(e,{});"handDrawn"!==e.look&&(k.roughness=0,k.fillStyle="solid");const $=b.rectangle(f,m,c,d,k),M=Math.max(c,y.width),v=d+y.height+x,D=b.rectangle(-M/2,-v/2,M,v,{...k,fill:"none",stroke:"none"}),C=g.insert(()=>$,":first-child"),P=g.insert(()=>D);if(e.img){const t=g.append("image");t.attr("href",e.img),t.attr("width",c),t.attr("height",d),t.attr("preserveAspectRatio","none"),t.attr("transform",`translate(${-c/2},${u?v/2-d:-v/2})`)}return p.attr("transform",`translate(${-y.width/2-(y.x-(y.left??0))},${u?-d/2-y.height/2-x/2:d/2-y.height/2+x/2})`),C.attr("transform",`translate(0,${u?y.height/2+x/2:-y.height/2-x/2})`),Ct(e,P),e.intersect=function(t){if(n.info("iconSquare intersect",e,t),!e.label)return Ut.rect(e,t);const a=e.x??0,s=e.y??0,r=e.height??0;let l=[];return l=u?[{x:a-y.width/2,y:s-r/2},{x:a+y.width/2,y:s-r/2},{x:a+y.width/2,y:s-r/2+y.height+x},{x:a+c/2,y:s-r/2+y.height+x},{x:a+c/2,y:s+r/2},{x:a-c/2,y:s+r/2},{x:a-c/2,y:s-r/2+y.height+x},{x:a-y.width/2,y:s-r/2+y.height+x}]:[{x:a-c/2,y:s-r/2},{x:a+c/2,y:s-r/2},{x:a+c/2,y:s-r/2+d},{x:a+y.width/2,y:s-r/2+d},{x:a+y.width/2/2,y:s+r/2},{x:a-y.width/2,y:s+r/2},{x:a-y.width/2,y:s-r/2+d},{x:a-c/2,y:s-r/2+d}],Ut.polygon(e,l,t)},g}async function Ne(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=Math.max(r.width+2*(e.padding??0),e?.width??0),i=Math.max(r.height+2*(e.padding??0),e?.height??0),o=[{x:0,y:0},{x:l,y:0},{x:l+3*i/6,y:-i},{x:-3*i/6,y:-i}];let h;const{cssStyles:c}=e;if("handDrawn"===e.look){const t=Mt.svg(n),a=w(e,{}),s=Bt(o),r=t.path(s,a);h=n.insert(()=>r,":first-child").attr("transform",`translate(${-l/2}, ${i/2})`),c&&h.attr("style",c)}else h=ae(n,l,i,o);return s&&h.attr("style",s),e.width=l,e.height=i,Ct(e,h),e.intersect=function(t){return Ut.polygon(e,o,t)},n}async function Re(t,e,a){const{labelStyles:n,nodeStyles:r}=S(e);e.labelStyle=n;const{shapeSvg:l,bbox:i}=await vt(t,e,Pt(e)),o=Math.max(i.width+2*a.labelPaddingX,e?.width||0),h=Math.max(i.height+2*a.labelPaddingY,e?.height||0),c=-o/2,d=-h/2;let g,{rx:y,ry:p}=e;const{cssStyles:u}=e;if(a?.rx&&a.ry&&(y=a.rx,p=a.ry),"handDrawn"===e.look){const t=Mt.svg(l),a=w(e,{}),n=y||p?t.path(Ot(c,d,o,h,y||0),a):t.rectangle(c,d,o,h,a);g=l.insert(()=>n,":first-child"),g.attr("class","basic label-container").attr("style",s(u))}else g=l.insert("rect",":first-child"),g.attr("class","basic label-container").attr("style",r).attr("rx",s(y)).attr("ry",s(p)).attr("x",c).attr("y",d).attr("width",o).attr("height",h);return Ct(e,g),e.calcIntersect=function(t,e){return Ut.rect(t,e)},e.intersect=function(t){return Ut.rect(e,t)},l}async function Te(t,e){const{shapeSvg:a,bbox:s,label:n}=await vt(t,e,"label"),r=a.insert("rect",":first-child");return r.attr("width",.1).attr("height",.1),a.attr("class","label edgeLabel"),n.attr("transform",`translate(${-s.width/2-(s.x-(s.left??0))}, ${-s.height/2-(s.y-(s.top??0))})`),Ct(e,r),e.intersect=function(t){return Ut.rect(e,t)},a}async function Ie(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=Math.max(r.width+(e.padding??0),e?.width??0),i=Math.max(r.height+(e.padding??0),e?.height??0),o=[{x:0,y:0},{x:l+3*i/6,y:0},{x:l,y:-i},{x:-3*i/6,y:-i}];let h;const{cssStyles:c}=e;if("handDrawn"===e.look){const t=Mt.svg(n),a=w(e,{}),s=Bt(o),r=t.path(s,a);h=n.insert(()=>r,":first-child").attr("transform",`translate(${-l/2}, ${i/2})`),c&&h.attr("style",c)}else h=ae(n,l,i,o);return s&&h.attr("style",s),e.width=l,e.height=i,Ct(e,h),e.intersect=function(t){return Ut.polygon(e,o,t)},n}async function Oe(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=Math.max(r.width+(e.padding??0),e?.width??0),i=Math.max(r.height+(e.padding??0),e?.height??0),o=[{x:-3*i/6,y:0},{x:l,y:0},{x:l+3*i/6,y:-i},{x:0,y:-i}];let h;const{cssStyles:c}=e;if("handDrawn"===e.look){const t=Mt.svg(n),a=w(e,{}),s=Bt(o),r=t.path(s,a);h=n.insert(()=>r,":first-child").attr("transform",`translate(${-l/2}, ${i/2})`),c&&h.attr("style",c)}else h=ae(n,l,i,o);return s&&h.attr("style",s),e.width=l,e.height=i,Ct(e,h),e.intersect=function(t){return Ut.polygon(e,o,t)},n}function We(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.label="",e.labelStyle=a;const r=t.insert("g").attr("class",Pt(e)).attr("id",e.domId??e.id),{cssStyles:l}=e,i=Math.max(35,e?.width??0),o=Math.max(35,e?.height??0),h=[{x:i,y:0},{x:0,y:o+3.5},{x:i-14,y:o+3.5},{x:0,y:2*o},{x:i,y:o-3.5},{x:14,y:o-3.5}],c=Mt.svg(r),d=w(e,{});"handDrawn"!==e.look&&(d.roughness=0,d.fillStyle="solid");const g=Bt(h),y=c.path(g,d),p=r.insert(()=>y,":first-child");return l&&"handDrawn"!==e.look&&p.selectAll("path").attr("style",l),s&&"handDrawn"!==e.look&&p.selectAll("path").attr("style",s),p.attr("transform",`translate(-${i/2},${-o})`),Ct(e,p),e.intersect=function(t){return n.info("lightningBolt intersect",e,t),Ut.polygon(e,h,t)},r}r(xe,"cylinder"),r(be,"dividedRectangle"),r(we,"doublecircle"),r(Se,"filledCircle"),r(ke,"flippedTriangle"),r($e,"forkJoin"),r(Me,"halfRoundedRectangle"),r(ve,"hexagon"),r(De,"hourglass"),r(Ce,"icon"),r(Pe,"iconCircle"),r(Be,"iconRounded"),r(Ae,"iconSquare"),r(Le,"imageSquare"),r(Ne,"inv_trapezoid"),r(Re,"drawRect"),r(Te,"labelRect"),r(Ie,"lean_left"),r(Oe,"lean_right"),r(We,"lightningBolt");var Ee=r((t,e,a,s,n,r,l)=>[`M${t},${e+r}`,`a${n},${r} 0,0,0 ${a},0`,`a${n},${r} 0,0,0 ${-a},0`,`l0,${s}`,`a${n},${r} 0,0,0 ${a},0`,"l0,"+-s,`M${t},${e+r+l}`,`a${n},${r} 0,0,0 ${a},0`].join(" "),"createCylinderPathD"),_e=r((t,e,a,s,n,r,l)=>[`M${t},${e+r}`,`M${t+a},${e+r}`,`a${n},${r} 0,0,0 ${-a},0`,`l0,${s}`,`a${n},${r} 0,0,0 ${a},0`,"l0,"+-s,`M${t},${e+r+l}`,`a${n},${r} 0,0,0 ${a},0`].join(" "),"createOuterCylinderPathD"),je=r((t,e,a,s,n,r)=>[`M${t-a/2},${-s/2}`,`a${n},${r} 0,0,0 ${a},0`].join(" "),"createInnerCylinderPathD");async function He(t,e){const{labelStyles:a,nodeStyles:n}=S(e);e.labelStyle=a;const{shapeSvg:r,bbox:l,label:i}=await vt(t,e,Pt(e)),o=Math.max(l.width+(e.padding??0),e.width??0),h=o/2,c=h/(2.5+o/50),d=Math.max(l.height+c+(e.padding??0),e.height??0),g=.1*d;let y;const{cssStyles:p}=e;if("handDrawn"===e.look){const t=Mt.svg(r),a=_e(0,0,o,d,h,c,g),s=je(0,c,o,d,h,c),n=w(e,{}),l=t.path(a,n),i=t.path(s,n);r.insert(()=>i,":first-child").attr("class","line"),y=r.insert(()=>l,":first-child"),y.attr("class","basic label-container"),p&&y.attr("style",p)}else{const t=Ee(0,0,o,d,h,c,g);y=r.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",s(p)).attr("style",n)}return y.attr("label-offset-y",c),y.attr("transform",`translate(${-o/2}, ${-(d/2+c)})`),Ct(e,y),i.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))}, ${-l.height/2+c-(l.y-(l.top??0))})`),e.intersect=function(t){const a=Ut.rect(e,t),s=a.x-(e.x??0);if(0!=h&&(Math.abs(s)<(e.width??0)/2||Math.abs(s)==(e.width??0)/2&&Math.abs(a.y-(e.y??0))>(e.height??0)/2-c)){let n=c*c*(1-s*s/(h*h));n>0&&(n=Math.sqrt(n)),n=c-n,t.y-(e.y??0)>0&&(n=-n),a.y+=n}return a},r}async function ze(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,label:l}=await vt(t,e,Pt(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),h=o/4,c=o+h,{cssStyles:d}=e,g=Mt.svg(n),y=w(e,{});"handDrawn"!==e.look&&(y.roughness=0,y.fillStyle="solid");const p=[{x:-i/2-i/2*.1,y:-c/2},{x:-i/2-i/2*.1,y:c/2},...At(-i/2-i/2*.1,c/2,i/2+i/2*.1,c/2,h,.8),{x:i/2+i/2*.1,y:-c/2},{x:-i/2-i/2*.1,y:-c/2},{x:-i/2,y:-c/2},{x:-i/2,y:c/2*1.1},{x:-i/2,y:-c/2}],u=g.polygon(p.map(t=>[t.x,t.y]),y),f=n.insert(()=>u,":first-child");return f.attr("class","basic label-container"),d&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",d),s&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",s),f.attr("transform",`translate(0,${-h/2})`),l.attr("transform",`translate(${-i/2+(e.padding??0)+i/2*.1/2-(r.x-(r.left??0))},${-o/2+(e.padding??0)-h/2-(r.y-(r.top??0))})`),Ct(e,f),e.intersect=function(t){return Ut.polygon(e,p,t)},n}async function qe(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,label:l}=await vt(t,e,Pt(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),h=-i/2,c=-o/2,{cssStyles:d}=e,g=Mt.svg(n),y=w(e,{}),p=[{x:h-5,y:c+5},{x:h-5,y:c+o+5},{x:h+i-5,y:c+o+5},{x:h+i-5,y:c+o},{x:h+i,y:c+o},{x:h+i,y:c+o-5},{x:h+i+5,y:c+o-5},{x:h+i+5,y:c-5},{x:h+5,y:c-5},{x:h+5,y:c},{x:h,y:c},{x:h,y:c+5}],u=[{x:h,y:c+5},{x:h+i-5,y:c+5},{x:h+i-5,y:c+o},{x:h+i,y:c+o},{x:h+i,y:c},{x:h,y:c}];"handDrawn"!==e.look&&(y.roughness=0,y.fillStyle="solid");const f=Bt(p),m=g.path(f,y),x=Bt(u),b=g.path(x,{...y,fill:"none"}),k=n.insert(()=>b,":first-child");return k.insert(()=>m,":first-child"),k.attr("class","basic label-container"),d&&"handDrawn"!==e.look&&k.selectAll("path").attr("style",d),s&&"handDrawn"!==e.look&&k.selectAll("path").attr("style",s),l.attr("transform",`translate(${-r.width/2-5-(r.x-(r.left??0))}, ${-r.height/2+5-(r.y-(r.top??0))})`),Ct(e,k),e.intersect=function(t){return Ut.polygon(e,p,t)},n}async function Ve(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,label:l}=await vt(t,e,Pt(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),h=o/4,c=o+h,d=-i/2,g=-c/2,{cssStyles:y}=e,p=At(d-5,g+c+5,d+i-5,g+c+5,h,.8),u=p?.[p.length-1],f=[{x:d-5,y:g+5},{x:d-5,y:g+c+5},...p,{x:d+i-5,y:u.y-5},{x:d+i,y:u.y-5},{x:d+i,y:u.y-10},{x:d+i+5,y:u.y-10},{x:d+i+5,y:g-5},{x:d+5,y:g-5},{x:d+5,y:g},{x:d,y:g},{x:d,y:g+5}],m=[{x:d,y:g+5},{x:d+i-5,y:g+5},{x:d+i-5,y:u.y-5},{x:d+i,y:u.y-5},{x:d+i,y:g},{x:d,y:g}],x=Mt.svg(n),b=w(e,{});"handDrawn"!==e.look&&(b.roughness=0,b.fillStyle="solid");const k=Bt(f),$=x.path(k,b),M=Bt(m),v=x.path(M,b),D=n.insert(()=>$,":first-child");return D.insert(()=>v),D.attr("class","basic label-container"),y&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",y),s&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",s),D.attr("transform",`translate(0,${-h/2})`),l.attr("transform",`translate(${-r.width/2-5-(r.x-(r.left??0))}, ${-r.height/2+5-h/2-(r.y-(r.top??0))})`),Ct(e,D),e.intersect=function(t){return Ut.polygon(e,f,t)},n}async function Fe(t,e,{config:{themeVariables:a}}){const{labelStyles:s,nodeStyles:n}=S(e);e.labelStyle=s,e.useHtmlLabels||!1!==f().flowchart?.htmlLabels||(e.centerLabel=!0);const{shapeSvg:r,bbox:l,label:i}=await vt(t,e,Pt(e)),o=Math.max(l.width+2*(e.padding??0),e?.width??0),h=Math.max(l.height+2*(e.padding??0),e?.height??0),c=-o/2,d=-h/2,{cssStyles:g}=e,y=Mt.svg(r),p=w(e,{fill:a.noteBkgColor,stroke:a.noteBorderColor});"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");const u=y.rectangle(c,d,o,h,p),m=r.insert(()=>u,":first-child");return m.attr("class","basic label-container"),g&&"handDrawn"!==e.look&&m.selectAll("path").attr("style",g),n&&"handDrawn"!==e.look&&m.selectAll("path").attr("style",n),i.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))}, ${-l.height/2-(l.y-(l.top??0))})`),Ct(e,m),e.intersect=function(t){return Ut.rect(e,t)},r}r(He,"linedCylinder"),r(ze,"linedWaveEdgedRect"),r(qe,"multiRect"),r(Ve,"multiWaveEdgedRectangle"),r(Fe,"note");var Ge=r((t,e,a)=>[`M${t+a/2},${e}`,`L${t+a},${e-a/2}`,`L${t+a/2},${e-a}`,`L${t},${e-a/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function Ze(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=r.width+e.padding+(r.height+e.padding),i=[{x:l/2,y:0},{x:l,y:-l/2},{x:l/2,y:-l},{x:0,y:-l/2}];let o;const{cssStyles:h}=e;if("handDrawn"===e.look){const t=Mt.svg(n),a=w(e,{}),s=Ge(0,0,l),r=t.path(s,a);o=n.insert(()=>r,":first-child").attr("transform",`translate(${-l/2+.5}, ${l/2})`),h&&o.attr("style",h)}else o=ae(n,l,l,i),o.attr("transform",`translate(${-l/2+.5}, ${l/2})`);return s&&o.attr("style",s),Ct(e,o),e.calcIntersect=function(t,e){const a=t.width,s=[{x:a/2,y:0},{x:a,y:-a/2},{x:a/2,y:-a},{x:0,y:-a/2}],n=Ut.polygon(t,s,e);return{x:n.x-.5,y:n.y-.5}},e.intersect=function(t){return this.calcIntersect(e,t)},n}async function Xe(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,label:l}=await vt(t,e,Pt(e)),i=-Math.max(r.width+(e.padding??0),e?.width??0)/2,o=-Math.max(r.height+(e.padding??0),e?.height??0)/2,h=o/2,c=[{x:i+h,y:o},{x:i,y:0},{x:i+h,y:-o},{x:-i,y:-o},{x:-i,y:o}],{cssStyles:d}=e,g=Mt.svg(n),y=w(e,{});"handDrawn"!==e.look&&(y.roughness=0,y.fillStyle="solid");const p=Bt(c),u=g.path(p,y),f=n.insert(()=>u,":first-child");return f.attr("class","basic label-container"),d&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",d),s&&"handDrawn"!==e.look&&f.selectAll("path").attr("style",s),f.attr("transform",`translate(${-h/2},0)`),l.attr("transform",`translate(${-h/2-r.width/2-(r.x-(r.left??0))}, ${-r.height/2-(r.y-(r.top??0))})`),Ct(e,f),e.intersect=function(t){return Ut.polygon(e,c,t)},n}async function Ye(t,e){const{labelStyles:a,nodeStyles:s}=S(e);let r;e.labelStyle=a,r=e.cssClasses?"node "+e.cssClasses:"node default";const i=t.insert("g").attr("class",r).attr("id",e.domId||e.id),o=i.insert("g"),h=i.insert("g").attr("class","label").attr("style",s),c=e.description,d=e.label,y=h.node().appendChild(await It(d,e.labelStyle,!0,!0));let u={width:0,height:0};if(p(g()?.flowchart?.htmlLabels)){const t=y.children[0],e=l(y);u=t.getBoundingClientRect(),e.attr("width",u.width),e.attr("height",u.height)}n.info("Text 2",c);const f=c||[],m=y.getBBox(),x=h.node().appendChild(await It(f.join?f.join("<br/>"):f,e.labelStyle,!0,!0)),b=x.children[0],k=l(x);u=b.getBoundingClientRect(),k.attr("width",u.width),k.attr("height",u.height);const $=(e.padding||0)/2;l(x).attr("transform","translate( "+(u.width>m.width?0:(m.width-u.width)/2)+", "+(m.height+$+5)+")"),l(y).attr("transform","translate( "+(u.width<m.width?0:-(m.width-u.width)/2)+", 0)"),u=h.node().getBBox(),h.attr("transform","translate("+-u.width/2+", "+(-u.height/2-$+3)+")");const M=u.width+(e.padding||0),v=u.height+(e.padding||0),D=-u.width/2-$,C=-u.height/2-$;let P,B;if("handDrawn"===e.look){const t=Mt.svg(i),a=w(e,{}),s=t.path(Ot(D,C,M,v,e.rx||0),a),r=t.line(-u.width/2-$,-u.height/2-$+m.height+$,u.width/2+$,-u.height/2-$+m.height+$,a);B=i.insert(()=>(n.debug("Rough node insert CXC",s),r),":first-child"),P=i.insert(()=>(n.debug("Rough node insert CXC",s),s),":first-child")}else P=o.insert("rect",":first-child"),B=o.insert("line"),P.attr("class","outer title-state").attr("style",s).attr("x",-u.width/2-$).attr("y",-u.height/2-$).attr("width",u.width+(e.padding||0)).attr("height",u.height+(e.padding||0)),B.attr("class","divider").attr("x1",-u.width/2-$).attr("x2",u.width/2+$).attr("y1",-u.height/2-$+m.height+$).attr("y2",-u.height/2-$+m.height+$);return Ct(e,P),e.intersect=function(t){return Ut.rect(e,t)},i}function Qe(t,e,a,s,n,r,l){const i=(t+a)/2,o=(e+s)/2,h=Math.atan2(s-e,a-t),c=(a-t)/2/n,d=(s-e)/2/r,g=Math.sqrt(c**2+d**2);if(g>1)throw new Error("The given radii are too small to create an arc between the points.");const y=Math.sqrt(1-g**2),p=i+y*r*Math.sin(h)*(l?-1:1),u=o-y*n*Math.cos(h)*(l?-1:1),f=Math.atan2((e-u)/r,(t-p)/n);let m=Math.atan2((s-u)/r,(a-p)/n)-f;l&&m<0&&(m+=2*Math.PI),!l&&m>0&&(m-=2*Math.PI);const x=[];for(let b=0;b<20;b++){const t=f+b/19*m,e=p+n*Math.cos(t),a=u+r*Math.sin(t);x.push({x:e,y:a})}return x}async function Je(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=e?.padding??0,i=e?.padding??0,o=(e?.width?e?.width:r.width)+2*l,h=(e?.height?e?.height:r.height)+2*i,c=e.radius||5,d=e.taper||5,{cssStyles:g}=e,y=Mt.svg(n),p=w(e,{});e.stroke&&(p.stroke=e.stroke),"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");const u=[{x:-o/2+d,y:-h/2},{x:o/2-d,y:-h/2},...Qe(o/2-d,-h/2,o/2,-h/2+d,c,c,!0),{x:o/2,y:-h/2+d},{x:o/2,y:h/2-d},...Qe(o/2,h/2-d,o/2-d,h/2,c,c,!0),{x:o/2-d,y:h/2},{x:-o/2+d,y:h/2},...Qe(-o/2+d,h/2,-o/2,h/2-d,c,c,!0),{x:-o/2,y:h/2-d},{x:-o/2,y:-h/2+d},...Qe(-o/2,-h/2+d,-o/2+d,-h/2,c,c,!0)],f=Bt(u),m=y.path(f,p),x=n.insert(()=>m,":first-child");return x.attr("class","basic label-container outer-path"),g&&"handDrawn"!==e.look&&x.selectChildren("path").attr("style",g),s&&"handDrawn"!==e.look&&x.selectChildren("path").attr("style",s),Ct(e,x),e.intersect=function(t){return Ut.polygon(e,u,t)},n}async function Ue(t,e){const{labelStyles:a,nodeStyles:n}=S(e);e.labelStyle=a;const{shapeSvg:r,bbox:l,label:i}=await vt(t,e,Pt(e)),o=e?.padding??0,h=Math.max(l.width+2*(e.padding??0),e?.width??0),c=Math.max(l.height+2*(e.padding??0),e?.height??0),d=-l.width/2-o,g=-l.height/2-o,{cssStyles:y}=e,p=Mt.svg(r),u=w(e,{});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");const f=[{x:d,y:g},{x:d+h+8,y:g},{x:d+h+8,y:g+c},{x:d-8,y:g+c},{x:d-8,y:g},{x:d,y:g},{x:d,y:g+c}],m=p.polygon(f.map(t=>[t.x,t.y]),u),x=r.insert(()=>m,":first-child");return x.attr("class","basic label-container").attr("style",s(y)),n&&"handDrawn"!==e.look&&x.selectAll("path").attr("style",n),y&&"handDrawn"!==e.look&&x.selectAll("path").attr("style",n),i.attr("transform",`translate(${-h/2+4+(e.padding??0)-(l.x-(l.left??0))},${-c/2+(e.padding??0)-(l.y-(l.top??0))})`),Ct(e,x),e.intersect=function(t){return Ut.rect(e,t)},r}async function Ke(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,label:l}=await vt(t,e,Pt(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),h=-i/2,c=-o/2,{cssStyles:d}=e,g=Mt.svg(n),y=w(e,{});"handDrawn"!==e.look&&(y.roughness=0,y.fillStyle="solid");const p=[{x:h,y:c},{x:h,y:c+o},{x:h+i,y:c+o},{x:h+i,y:c-o/2}],u=Bt(p),f=g.path(u,y),m=n.insert(()=>f,":first-child");return m.attr("class","basic label-container"),d&&"handDrawn"!==e.look&&m.selectChildren("path").attr("style",d),s&&"handDrawn"!==e.look&&m.selectChildren("path").attr("style",s),m.attr("transform",`translate(0, ${o/4})`),l.attr("transform",`translate(${-i/2+(e.padding??0)-(r.x-(r.left??0))}, ${-o/4+(e.padding??0)-(r.y-(r.top??0))})`),Ct(e,m),e.intersect=function(t){return Ut.polygon(e,p,t)},n}async function ta(t,e){return Re(t,e,{rx:0,ry:0,classes:"",labelPaddingX:e.labelPaddingX??2*(e?.padding||0),labelPaddingY:1*(e?.padding||0)})}async function ea(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=r.height+e.padding,i=r.width+l/4+e.padding,o=l/2,{cssStyles:h}=e,c=Mt.svg(n),d=w(e,{});"handDrawn"!==e.look&&(d.roughness=0,d.fillStyle="solid");const g=[{x:-i/2+o,y:-l/2},{x:i/2-o,y:-l/2},...Lt(-i/2+o,0,o,50,90,270),{x:i/2-o,y:l/2},...Lt(i/2-o,0,o,50,270,450)],y=Bt(g),p=c.path(y,d),u=n.insert(()=>p,":first-child");return u.attr("class","basic label-container outer-path"),h&&"handDrawn"!==e.look&&u.selectChildren("path").attr("style",h),s&&"handDrawn"!==e.look&&u.selectChildren("path").attr("style",s),Ct(e,u),e.intersect=function(t){return Ut.polygon(e,g,t)},n}async function aa(t,e){return Re(t,e,{rx:5,ry:5,classes:"flowchart-node"})}function sa(t,e,{config:{themeVariables:a}}){const{labelStyles:s,nodeStyles:n}=S(e);e.labelStyle=s;const{cssStyles:r}=e,{lineColor:l,stateBorder:i,nodeBorder:o}=a,h=t.insert("g").attr("class","node default").attr("id",e.domId||e.id),c=Mt.svg(h),d=w(e,{});"handDrawn"!==e.look&&(d.roughness=0,d.fillStyle="solid");const g=c.circle(0,0,14,{...d,stroke:l,strokeWidth:2}),y=i??o,p=c.circle(0,0,5,{...d,fill:y,stroke:y,strokeWidth:2,fillStyle:"solid"}),u=h.insert(()=>g,":first-child");return u.insert(()=>p),r&&u.selectAll("path").attr("style",r),n&&u.selectAll("path").attr("style",n),Ct(e,u),e.intersect=function(t){return Ut.circle(e,7,t)},h}function na(t,e,{config:{themeVariables:a}}){const{lineColor:s}=a,n=t.insert("g").attr("class","node default").attr("id",e.domId||e.id);let r;if("handDrawn"===e.look){const t=Mt.svg(n).circle(0,0,14,k(s));r=n.insert(()=>t),r.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else r=n.insert("circle",":first-child"),r.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return Ct(e,r),e.intersect=function(t){return Ut.circle(e,7,t)},n}async function ra(t,e){const{labelStyles:a,nodeStyles:n}=S(e);e.labelStyle=a;const{shapeSvg:r,bbox:l}=await vt(t,e,Pt(e)),i=(e?.padding||0)/2,o=l.width+e.padding,h=l.height+e.padding,c=-l.width/2-i,d=-l.height/2-i,g=[{x:0,y:0},{x:o,y:0},{x:o,y:-h},{x:0,y:-h},{x:0,y:0},{x:-8,y:0},{x:o+8,y:0},{x:o+8,y:-h},{x:-8,y:-h},{x:-8,y:0}];if("handDrawn"===e.look){const t=Mt.svg(r),a=w(e,{}),n=t.rectangle(c-8,d,o+16,h,a),l=t.line(c,d,c,d+h,a),i=t.line(c+o,d,c+o,d+h,a);r.insert(()=>l,":first-child"),r.insert(()=>i,":first-child");const g=r.insert(()=>n,":first-child"),{cssStyles:y}=e;g.attr("class","basic label-container").attr("style",s(y)),Ct(e,g)}else{const t=ae(r,o,h,g);n&&t.attr("style",n),Ct(e,t)}return e.intersect=function(t){return Ut.polygon(e,g,t)},r}async function la(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=Math.max(r.width+2*(e.padding??0),e?.width??0),i=Math.max(r.height+2*(e.padding??0),e?.height??0),o=-l/2,h=-i/2,c=.2*i,d=.2*i,{cssStyles:g}=e,y=Mt.svg(n),p=w(e,{}),u=[{x:o-c/2,y:h},{x:o+l+c/2,y:h},{x:o+l+c/2,y:h+i},{x:o-c/2,y:h+i}],f=[{x:o+l-c/2,y:h+i},{x:o+l+c/2,y:h+i},{x:o+l+c/2,y:h+i-d}];"handDrawn"!==e.look&&(p.roughness=0,p.fillStyle="solid");const m=Bt(u),x=y.path(m,p),b=Bt(f),k=y.path(b,{...p,fillStyle:"solid"}),$=n.insert(()=>k,":first-child");return $.insert(()=>x,":first-child"),$.attr("class","basic label-container"),g&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",g),s&&"handDrawn"!==e.look&&$.selectAll("path").attr("style",s),Ct(e,$),e.intersect=function(t){return Ut.polygon(e,u,t)},n}async function ia(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,label:l}=await vt(t,e,Pt(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),h=o/4,c=.2*i,d=.2*o,g=o+h,{cssStyles:y}=e,p=Mt.svg(n),u=w(e,{});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");const f=[{x:-i/2-i/2*.1,y:g/2},...At(-i/2-i/2*.1,g/2,i/2+i/2*.1,g/2,h,.8),{x:i/2+i/2*.1,y:-g/2},{x:-i/2-i/2*.1,y:-g/2}],m=-i/2+i/2*.1,x=-g/2-.4*d,b=[{x:m+i-c,y:1.4*(x+o)},{x:m+i,y:x+o-d},{x:m+i,y:.9*(x+o)},...At(m+i,1.3*(x+o),m+i-c,1.5*(x+o),.03*-o,.5)],k=Bt(f),$=p.path(k,u),M=Bt(b),v=p.path(M,{...u,fillStyle:"solid"}),D=n.insert(()=>v,":first-child");return D.insert(()=>$,":first-child"),D.attr("class","basic label-container"),y&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",y),s&&"handDrawn"!==e.look&&D.selectAll("path").attr("style",s),D.attr("transform",`translate(0,${-h/2})`),l.attr("transform",`translate(${-i/2+(e.padding??0)-(r.x-(r.left??0))},${-o/2+(e.padding??0)-h/2-(r.y-(r.top??0))})`),Ct(e,D),e.intersect=function(t){return Ut.polygon(e,f,t)},n}async function oa(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=Math.max(r.width+e.padding,e?.width||0),i=Math.max(r.height+e.padding,e?.height||0),o=-l/2,h=-i/2,c=n.insert("rect",":first-child");return c.attr("class","text").attr("style",s).attr("rx",0).attr("ry",0).attr("x",o).attr("y",h).attr("width",l).attr("height",i),Ct(e,c),e.intersect=function(t){return Ut.rect(e,t)},n}r(Ze,"question"),r(Xe,"rect_left_inv_arrow"),r(Ye,"rectWithTitle"),r(Qe,"generateArcPoints"),r(Je,"roundedRect"),r(Ue,"shadedProcess"),r(Ke,"slopedRect"),r(ta,"squareRect"),r(ea,"stadium"),r(aa,"state"),r(sa,"stateEnd"),r(na,"stateStart"),r(ra,"subroutine"),r(la,"taggedRect"),r(ia,"taggedWaveEdgedRectangle"),r(oa,"text");var ha=r((t,e,a,s,n,r)=>`M${t},${e}\n    a${n},${r} 0,0,1 0,${-s}\n    l${a},0\n    a${n},${r} 0,0,1 0,${s}\n    M${a},${-s}\n    a${n},${r} 0,0,0 0,${s}\n    l${-a},0`,"createCylinderPathD"),ca=r((t,e,a,s,n,r)=>[`M${t},${e}`,`M${t+a},${e}`,`a${n},${r} 0,0,0 0,${-s}`,`l${-a},0`,`a${n},${r} 0,0,0 0,${s}`,`l${a},0`].join(" "),"createOuterCylinderPathD"),da=r((t,e,a,s,n,r)=>[`M${t+a/2},${-s/2}`,`a${n},${r} 0,0,0 0,${s}`].join(" "),"createInnerCylinderPathD");async function ga(t,e){const{labelStyles:a,nodeStyles:n}=S(e);e.labelStyle=a;const{shapeSvg:r,bbox:l,label:i,halfPadding:o}=await vt(t,e,Pt(e)),h="neo"===e.look?2*o:o,c=l.height+h,d=c/2,g=d/(2.5+c/50),y=l.width+g+h,{cssStyles:p}=e;let u;if("handDrawn"===e.look){const t=Mt.svg(r),a=ca(0,0,y,c,g,d),s=da(0,0,y,c,g,d),n=t.path(a,w(e,{})),l=t.path(s,w(e,{fill:"none"}));u=r.insert(()=>l,":first-child"),u=r.insert(()=>n,":first-child"),u.attr("class","basic label-container"),p&&u.attr("style",p)}else{const t=ha(0,0,y,c,g,d);u=r.insert("path",":first-child").attr("d",t).attr("class","basic label-container").attr("style",s(p)).attr("style",n),u.attr("class","basic label-container"),p&&u.selectAll("path").attr("style",p),n&&u.selectAll("path").attr("style",n)}return u.attr("label-offset-x",g),u.attr("transform",`translate(${-y/2}, ${c/2} )`),i.attr("transform",`translate(${-l.width/2-g-(l.x-(l.left??0))}, ${-l.height/2-(l.y-(l.top??0))})`),Ct(e,u),e.intersect=function(t){const a=Ut.rect(e,t),s=a.y-(e.y??0);if(0!=d&&(Math.abs(s)<(e.height??0)/2||Math.abs(s)==(e.height??0)/2&&Math.abs(a.x-(e.x??0))>(e.width??0)/2-g)){let n=g*g*(1-s*s/(d*d));0!=n&&(n=Math.sqrt(Math.abs(n))),n=g-n,t.x-(e.x??0)>0&&(n=-n),a.x+=n}return a},r}async function ya(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=r.width+e.padding,i=r.height+e.padding,o=[{x:-3*i/6,y:0},{x:l+3*i/6,y:0},{x:l,y:-i},{x:0,y:-i}];let h;const{cssStyles:c}=e;if("handDrawn"===e.look){const t=Mt.svg(n),a=w(e,{}),s=Bt(o),r=t.path(s,a);h=n.insert(()=>r,":first-child").attr("transform",`translate(${-l/2}, ${i/2})`),c&&h.attr("style",c)}else h=ae(n,l,i,o);return s&&h.attr("style",s),e.width=l,e.height=i,Ct(e,h),e.intersect=function(t){return Ut.polygon(e,o,t)},n}async function pa(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=Math.max(60,r.width+2*(e.padding??0),e?.width??0),i=Math.max(20,r.height+2*(e.padding??0),e?.height??0),{cssStyles:o}=e,h=Mt.svg(n),c=w(e,{});"handDrawn"!==e.look&&(c.roughness=0,c.fillStyle="solid");const d=[{x:-l/2*.8,y:-i/2},{x:l/2*.8,y:-i/2},{x:l/2,y:-i/2*.6},{x:l/2,y:i/2},{x:-l/2,y:i/2},{x:-l/2,y:-i/2*.6}],g=Bt(d),y=h.path(g,c),p=n.insert(()=>y,":first-child");return p.attr("class","basic label-container"),o&&"handDrawn"!==e.look&&p.selectChildren("path").attr("style",o),s&&"handDrawn"!==e.look&&p.selectChildren("path").attr("style",s),Ct(e,p),e.intersect=function(t){return Ut.polygon(e,d,t)},n}async function ua(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:r,bbox:l,label:i}=await vt(t,e,Pt(e)),o=p(g().flowchart?.htmlLabels),h=l.width+(e.padding??0),c=h+l.height,d=h+l.height,y=[{x:0,y:0},{x:d,y:0},{x:d/2,y:-c}],{cssStyles:u}=e,f=Mt.svg(r),m=w(e,{});"handDrawn"!==e.look&&(m.roughness=0,m.fillStyle="solid");const x=Bt(y),b=f.path(x,m),k=r.insert(()=>b,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return u&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",u),s&&"handDrawn"!==e.look&&k.selectChildren("path").attr("style",s),e.width=h,e.height=c,Ct(e,k),i.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))}, ${c/2-(l.height+(e.padding??0)/(o?2:1)-(l.y-(l.top??0)))})`),e.intersect=function(t){return n.info("Triangle intersect",e,y,t),Ut.polygon(e,y,t)},r}async function fa(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,label:l}=await vt(t,e,Pt(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),h=o/8,c=o+h,{cssStyles:d}=e,g=70-i,y=g>0?g/2:0,p=Mt.svg(n),u=w(e,{});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");const f=[{x:-i/2-y,y:c/2},...At(-i/2-y,c/2,i/2+y,c/2,h,.8),{x:i/2+y,y:-c/2},{x:-i/2-y,y:-c/2}],m=Bt(f),x=p.path(m,u),b=n.insert(()=>x,":first-child");return b.attr("class","basic label-container"),d&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",d),s&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",s),b.attr("transform",`translate(0,${-h/2})`),l.attr("transform",`translate(${-i/2+(e.padding??0)-(r.x-(r.left??0))},${-o/2+(e.padding??0)-h-(r.y-(r.top??0))})`),Ct(e,b),e.intersect=function(t){return Ut.polygon(e,f,t)},n}async function ma(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r}=await vt(t,e,Pt(e)),l=Math.max(r.width+2*(e.padding??0),e?.width??0),i=Math.max(r.height+2*(e.padding??0),e?.height??0),o=l/i;let h=l,c=i;h>c*o?c=h/o:h=c*o,h=Math.max(h,100),c=Math.max(c,50);const d=Math.min(.2*c,c/4),g=c+2*d,{cssStyles:y}=e,p=Mt.svg(n),u=w(e,{});"handDrawn"!==e.look&&(u.roughness=0,u.fillStyle="solid");const f=[{x:-h/2,y:g/2},...At(-h/2,g/2,h/2,g/2,d,1),{x:h/2,y:-g/2},...At(h/2,-g/2,-h/2,-g/2,d,-1)],m=Bt(f),x=p.path(m,u),b=n.insert(()=>x,":first-child");return b.attr("class","basic label-container"),y&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",y),s&&"handDrawn"!==e.look&&b.selectAll("path").attr("style",s),Ct(e,b),e.intersect=function(t){return Ut.polygon(e,f,t)},n}async function xa(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,label:l}=await vt(t,e,Pt(e)),i=Math.max(r.width+2*(e.padding??0),e?.width??0),o=Math.max(r.height+2*(e.padding??0),e?.height??0),h=-i/2,c=-o/2,{cssStyles:d}=e,g=Mt.svg(n),y=w(e,{}),p=[{x:h-5,y:c-5},{x:h-5,y:c+o},{x:h+i,y:c+o},{x:h+i,y:c-5}],u=`M${h-5},${c-5} L${h+i},${c-5} L${h+i},${c+o} L${h-5},${c+o} L${h-5},${c-5}\n                M${h-5},${c} L${h+i},${c}\n                M${h},${c-5} L${h},${c+o}`;"handDrawn"!==e.look&&(y.roughness=0,y.fillStyle="solid");const f=g.path(u,y),m=n.insert(()=>f,":first-child");return m.attr("transform","translate(2.5, 2.5)"),m.attr("class","basic label-container"),d&&"handDrawn"!==e.look&&m.selectAll("path").attr("style",d),s&&"handDrawn"!==e.look&&m.selectAll("path").attr("style",s),l.attr("transform",`translate(${-r.width/2+2.5-(r.x-(r.left??0))}, ${-r.height/2+2.5-(r.y-(r.top??0))})`),Ct(e,m),e.intersect=function(t){return Ut.polygon(e,p,t)},n}async function ba(t,e){const s=e;if(s.alias&&(e.label=s.alias),"handDrawn"===e.look){const{themeVariables:a}=f(),{background:s}=a;await ba(t,{...e,id:e.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${s}`]})}const n=f();e.useHtmlLabels=n.htmlLabels;let r=n.er?.diagramPadding??10,i=n.er?.entityPadding??6;const{cssStyles:o}=e,{labelStyles:h,nodeStyles:c}=S(e);if(0===s.attributes.length&&e.label){const s={rx:0,ry:0,labelPaddingX:r,labelPaddingY:1.5*r,classes:""};a(e.label,n)+2*s.labelPaddingX<n.er.minEntityWidth&&(e.width=n.er.minEntityWidth);const l=await Re(t,e,s);if(!p(n.htmlLabels)){const t=l.select("text"),e=t.node()?.getBBox();t.attr("transform",`translate(${-e.width/2}, 0)`)}return l}n.htmlLabels||(r*=1.25,i*=1.25);let d=Pt(e);d||(d="node default");const g=t.insert("g").attr("class",d).attr("id",e.domId||e.id),y=await wa(g,e.label??"",n,0,0,["name"],h);y.height+=i;let u=0;const m=[],x=[];let b=0,k=0,$=0,M=0,v=!0,D=!0;for(const a of s.attributes){const t=await wa(g,a.type,n,0,u,["attribute-type"],h);b=Math.max(b,t.width+r);const e=await wa(g,a.name,n,0,u,["attribute-name"],h);k=Math.max(k,e.width+r);const s=await wa(g,a.keys.join(),n,0,u,["attribute-keys"],h);$=Math.max($,s.width+r);const l=await wa(g,a.comment,n,0,u,["attribute-comment"],h);M=Math.max(M,l.width+r);const o=Math.max(t.height,e.height,s.height,l.height)+i;x.push({yOffset:u,rowHeight:o}),u+=o}let C=4;$<=r&&(v=!1,$=0,C--),M<=r&&(D=!1,M=0,C--);const P=g.node().getBBox();if(y.width+2*r-(b+k+$+M)>0){const t=y.width+2*r-(b+k+$+M);b+=t/C,k+=t/C,$>0&&($+=t/C),M>0&&(M+=t/C)}const B=b+k+$+M,A=Mt.svg(g),L=w(e,{});"handDrawn"!==e.look&&(L.roughness=0,L.fillStyle="solid");let N=0;x.length>0&&(N=x.reduce((t,e)=>t+(e?.rowHeight??0),0));const R=Math.max(P.width+2*r,e?.width||0,B),T=Math.max((N??0)+y.height,e?.height||0),I=-R/2,O=-T/2;g.selectAll("g:not(:first-child)").each((t,e,a)=>{const s=l(a[e]),n=s.attr("transform");let o=0,h=0;if(n){const t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(n);t&&(o=parseFloat(t[1]),h=parseFloat(t[2]),s.attr("class").includes("attribute-name")?o+=b:s.attr("class").includes("attribute-keys")?o+=b+k:s.attr("class").includes("attribute-comment")&&(o+=b+k+$))}s.attr("transform",`translate(${I+r/2+o}, ${h+O+y.height+i/2})`)}),g.select(".name").attr("transform","translate("+-y.width/2+", "+(O+i/2)+")");const W=A.rectangle(I,O,R,T,L),E=g.insert(()=>W,":first-child").attr("style",o.join("")),{themeVariables:_}=f(),{rowEven:j,rowOdd:H,nodeBorder:z}=_;m.push(0);for(const[a,l]of x.entries()){const t=(a+1)%2==0&&0!==l.yOffset,e=A.rectangle(I,y.height+O+l?.yOffset,R,l?.rowHeight,{...L,fill:t?j:H,stroke:z});g.insert(()=>e,"g.label").attr("style",o.join("")).attr("class","row-rect-"+(t?"even":"odd"))}let q=A.line(I,y.height+O,R+I,y.height+O,L);g.insert(()=>q).attr("class","divider"),q=A.line(b+I,y.height+O,b+I,T+O,L),g.insert(()=>q).attr("class","divider"),v&&(q=A.line(b+k+I,y.height+O,b+k+I,T+O,L),g.insert(()=>q).attr("class","divider")),D&&(q=A.line(b+k+$+I,y.height+O,b+k+$+I,T+O,L),g.insert(()=>q).attr("class","divider"));for(const a of m)q=A.line(I,y.height+O+a,R+I,y.height+O+a,L),g.insert(()=>q).attr("class","divider");if(Ct(e,E),c&&"handDrawn"!==e.look){const t=c.split(";")?.filter(t=>t.includes("stroke"))?.map(t=>`${t}`).join("; ");g.selectAll("path").attr("style",t??""),g.selectAll(".row-rect-even path").attr("style",c)}return e.intersect=function(t){return Ut.rect(e,t)},g}async function wa(t,e,s,n=0,r=0,o=[],h=""){const c=t.insert("g").attr("class",`label ${o.join(" ")}`).attr("transform",`translate(${n}, ${r})`).attr("style",h);e!==i(e)&&(e=(e=i(e)).replaceAll("<","&lt;").replaceAll(">","&gt;"));const d=c.node().appendChild(await m(c,e,{width:a(e,s)+100,style:h,useHtmlLabels:s.htmlLabels},s));if(e.includes("&lt;")||e.includes("&gt;")){let t=d.children[0];for(t.textContent=t.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");t.childNodes[0];)t=t.childNodes[0],t.textContent=t.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let g=d.getBBox();if(p(s.htmlLabels)){const t=d.children[0];t.style.textAlign="start";const e=l(d);g=t.getBoundingClientRect(),e.attr("width",g.width),e.attr("height",g.height)}return g}async function Sa(t,e,a,s,n=a.class.padding??12){const r=s?0:3,l=t.insert("g").attr("class",Pt(e)).attr("id",e.domId||e.id);let i=null,o=null,h=null,c=null,d=0,g=0,y=0;if(i=l.insert("g").attr("class","annotation-group text"),e.annotations.length>0){const t=e.annotations[0];await ka(i,{text:`${t}`},0),d=i.node().getBBox().height}o=l.insert("g").attr("class","label-group text"),await ka(o,e,0,["font-weight: bolder"]);const p=o.node().getBBox();g=p.height,h=l.insert("g").attr("class","members-group text");let u=0;for(const x of e.members){u+=await ka(h,x,u,[x.parseClassifier()])+r}y=h.node().getBBox().height,y<=0&&(y=n/2),c=l.insert("g").attr("class","methods-group text");let f=0;for(const x of e.methods){f+=await ka(c,x,f,[x.parseClassifier()])+r}let m=l.node().getBBox();if(null!==i){const t=i.node().getBBox();i.attr("transform",`translate(${-t.width/2})`)}return o.attr("transform",`translate(${-p.width/2}, ${d})`),m=l.node().getBBox(),h.attr("transform",`translate(0, ${d+g+2*n})`),m=l.node().getBBox(),c.attr("transform",`translate(0, ${d+g+(y?y+4*n:2*n)})`),m=l.node().getBBox(),{shapeSvg:l,bbox:m}}async function ka(e,s,n,i=[]){const o=e.insert("g").attr("class","label").attr("style",i.join("; ")),c=f();let g="useHtmlLabels"in s?s.useHtmlLabels:p(c.htmlLabels)??!0,y="";y="text"in s?s.text:s.label,!g&&y.startsWith("\\")&&(y=y.substring(1)),d(y)&&(g=!0);const u=await m(o,h(t(y)),{width:a(y,c)+50,classes:"markdown-node-label",useHtmlLabels:g},c);let x,b=1;if(g){const t=u.children[0],e=l(u);b=t.innerHTML.split("<br>").length,t.innerHTML.includes("</math>")&&(b+=t.innerHTML.split("<mrow>").length-1);const a=t.getElementsByTagName("img");if(a){const t=""===y.replace(/<img[^>]*>/g,"").trim();await Promise.all([...a].map(e=>new Promise(a=>{function s(){if(e.style.display="flex",e.style.flexDirection="column",t){const t=c.fontSize?.toString()??window.getComputedStyle(document.body).fontSize,a=5*parseInt(t,10)+"px";e.style.minWidth=a,e.style.maxWidth=a}else e.style.width="100%";a(e)}r(s,"setupImage"),setTimeout(()=>{e.complete&&s()}),e.addEventListener("error",s),e.addEventListener("load",s)})))}x=t.getBoundingClientRect(),e.attr("width",x.width),e.attr("height",x.height)}else{i.includes("font-weight: bolder")&&l(u).selectAll("tspan").attr("font-weight",""),b=u.children.length;const t=u.children[0];(""===u.textContent||u.textContent.includes("&gt"))&&(t.textContent=y[0]+y.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim()," "===y[1]&&(t.textContent=t.textContent[0]+" "+t.textContent.substring(1))),"undefined"===t.textContent&&(t.textContent=""),x=u.getBBox()}return o.attr("transform","translate(0,"+(-x.height/(2*b)+n)+")"),x.height}async function $a(t,e){const a=g(),s=a.class.padding??12,n=s,r=e.useHtmlLabels??p(a.htmlLabels)??!0,i=e;i.annotations=i.annotations??[],i.members=i.members??[],i.methods=i.methods??[];const{shapeSvg:o,bbox:h}=await Sa(t,e,a,r,n),{labelStyles:c,nodeStyles:d}=S(e);e.labelStyle=c,e.cssStyles=i.styles||"";const y=i.styles?.join(";")||d||"";e.cssStyles||(e.cssStyles=y.replaceAll("!important","").split(";"));const u=0===i.members.length&&0===i.methods.length&&!a.class?.hideEmptyMembersBox,f=Mt.svg(o),m=w(e,{});"handDrawn"!==e.look&&(m.roughness=0,m.fillStyle="solid");const x=h.width;let b=h.height;0===i.members.length&&0===i.methods.length?b+=n:i.members.length>0&&0===i.methods.length&&(b+=2*n);const k=-x/2,$=-b/2,M=f.rectangle(k-s,$-s-(u?s:0===i.members.length&&0===i.methods.length?-s/2:0),x+2*s,b+2*s+(u?2*s:0===i.members.length&&0===i.methods.length?-s:0),m),v=o.insert(()=>M,":first-child");v.attr("class","basic label-container");const D=v.node().getBBox();o.selectAll(".text").each((t,e,a)=>{const n=l(a[e]),h=n.attr("transform");let c=0;if(h){const t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(h);t&&(c=parseFloat(t[2]))}let d=c+$+s-(u?s:0===i.members.length&&0===i.methods.length?-s/2:0);r||(d-=4);let g=k;(n.attr("class").includes("label-group")||n.attr("class").includes("annotation-group"))&&(g=-n.node()?.getBBox().width/2||0,o.selectAll("text").each(function(t,e,a){"middle"===window.getComputedStyle(a[e]).textAnchor&&(g=0)})),n.attr("transform",`translate(${g}, ${d})`)});const C=o.select(".annotation-group").node().getBBox().height-(u?s/2:0)||0,P=o.select(".label-group").node().getBBox().height-(u?s/2:0)||0,B=o.select(".members-group").node().getBBox().height-(u?s/2:0)||0;if(i.members.length>0||i.methods.length>0||u){const t=f.line(D.x,C+P+$+s,D.x+D.width,C+P+$+s,m);o.insert(()=>t).attr("class","divider").attr("style",y)}if(u||i.members.length>0||i.methods.length>0){const t=f.line(D.x,C+P+B+$+2*n+s,D.x+D.width,C+P+B+$+s+2*n,m);o.insert(()=>t).attr("class","divider").attr("style",y)}if("handDrawn"!==i.look&&o.selectAll("path").attr("style",y),v.select(":nth-child(2)").attr("style",y),o.selectAll(".divider").select("path").attr("style",y),e.labelStyle?o.selectAll("span").attr("style",e.labelStyle):o.selectAll("span").attr("style",y),!r){const t=RegExp(/color\s*:\s*([^;]*)/),e=t.exec(y);if(e){const t=e[0].replace("color","fill");o.selectAll("tspan").attr("style",t)}else if(c){const e=t.exec(c);if(e){const t=e[0].replace("color","fill");o.selectAll("tspan").attr("style",t)}}}return Ct(e,v),e.intersect=function(t){return Ut.rect(e,t)},o}async function Ma(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const n=e,r=e,i="verifyMethod"in e,o=Pt(e),h=t.insert("g").attr("class",o).attr("id",e.domId??e.id);let c;c=i?await va(h,`&lt;&lt;${n.type}&gt;&gt;`,0,e.labelStyle):await va(h,"&lt;&lt;Element&gt;&gt;",0,e.labelStyle);let d=c;const g=await va(h,n.name,d,e.labelStyle+"; font-weight: bold;");if(d+=g+20,i){d+=await va(h,""+(n.requirementId?`ID: ${n.requirementId}`:""),d,e.labelStyle);d+=await va(h,""+(n.text?`Text: ${n.text}`:""),d,e.labelStyle);d+=await va(h,""+(n.risk?`Risk: ${n.risk}`:""),d,e.labelStyle),await va(h,""+(n.verifyMethod?`Verification: ${n.verifyMethod}`:""),d,e.labelStyle)}else{d+=await va(h,""+(r.type?`Type: ${r.type}`:""),d,e.labelStyle),await va(h,""+(r.docRef?`Doc Ref: ${r.docRef}`:""),d,e.labelStyle)}const y=(h.node()?.getBBox().width??200)+20,p=(h.node()?.getBBox().height??200)+20,u=-y/2,f=-p/2,m=Mt.svg(h),x=w(e,{});"handDrawn"!==e.look&&(x.roughness=0,x.fillStyle="solid");const b=m.rectangle(u,f,y,p,x),k=h.insert(()=>b,":first-child");if(k.attr("class","basic label-container").attr("style",s),h.selectAll(".label").each((t,e,a)=>{const s=l(a[e]),n=s.attr("transform");let r=0,i=0;if(n){const t=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(n);t&&(r=parseFloat(t[1]),i=parseFloat(t[2]))}const o=i-p/2;let h=u+10;0!==e&&1!==e||(h=r),s.attr("transform",`translate(${h}, ${o+20})`)}),d>c+g+20){const t=m.line(u,f+c+g+20,u+y,f+c+g+20,x);h.insert(()=>t).attr("style",s)}return Ct(e,k),e.intersect=function(t){return Ut.rect(e,t)},h}async function va(e,s,n,r=""){if(""===s)return 0;const i=e.insert("g").attr("class","label").attr("style",r),o=g(),c=o.htmlLabels??!0,d=await m(i,h(t(s)),{width:a(s,o)+50,classes:"markdown-node-label",useHtmlLabels:c,style:r},o);let y;if(c){const t=d.children[0],e=l(d);y=t.getBoundingClientRect(),e.attr("width",y.width),e.attr("height",y.height)}else{const t=d.children[0];for(const e of t.children)e.textContent=e.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),r&&e.setAttribute("style",r);y=d.getBBox(),y.height+=6}return i.attr("transform",`translate(${-y.width/2},${-y.height/2+n})`),y.height}r(ga,"tiltedCylinder"),r(ya,"trapezoid"),r(pa,"trapezoidalPentagon"),r(ua,"triangle"),r(fa,"waveEdgedRectangle"),r(ma,"waveRectangle"),r(xa,"windowPane"),r(ba,"erBox"),r(wa,"addText"),r(Sa,"textHelper"),r(ka,"addText"),r($a,"classBox"),r(Ma,"requirementBox"),r(va,"addText");var Da=r(t=>{switch(t){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function Ca(t,e,{config:a}){const{labelStyles:s,nodeStyles:n}=S(e);e.labelStyle=s||"";const r=e.width;e.width=(e.width??200)-10;const{shapeSvg:l,bbox:i,label:o}=await vt(t,e,Pt(e)),h=e.padding||10;let c,d="";"ticket"in e&&e.ticket&&a?.kanban?.ticketBaseUrl&&(d=a?.kanban?.ticketBaseUrl.replace("#TICKET#",e.ticket),c=l.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",d).attr("target","_blank"));const g={useHtmlLabels:e.useHtmlLabels,labelStyle:e.labelStyle||"",width:e.width,img:e.img,padding:e.padding||8,centerLabel:!1};let y,p;({label:y,bbox:p}=c?await Dt(c,"ticket"in e&&e.ticket||"",g):await Dt(l,"ticket"in e&&e.ticket||"",g));const{label:u,bbox:f}=await Dt(l,"assigned"in e&&e.assigned||"",g);e.width=r;const m=e?.width||0,x=Math.max(p.height,f.height)/2,b=Math.max(i.height+20,e?.height||0)+x,k=-m/2,$=-b/2;let M;o.attr("transform","translate("+(h-m/2)+", "+(-x-i.height/2)+")"),y.attr("transform","translate("+(h-m/2)+", "+(-x+i.height/2)+")"),u.attr("transform","translate("+(h+m/2-f.width-20)+", "+(-x+i.height/2)+")");const{rx:v,ry:D}=e,{cssStyles:C}=e;if("handDrawn"===e.look){const t=Mt.svg(l),a=w(e,{}),s=v||D?t.path(Ot(k,$,m,b,v||0),a):t.rectangle(k,$,m,b,a);M=l.insert(()=>s,":first-child"),M.attr("class","basic label-container").attr("style",C||null)}else{M=l.insert("rect",":first-child"),M.attr("class","basic label-container __APA__").attr("style",n).attr("rx",v??5).attr("ry",D??5).attr("x",k).attr("y",$).attr("width",m).attr("height",b);const t="priority"in e&&e.priority;if(t){const e=l.append("line"),a=k+2,s=$+Math.floor((v??0)/2),n=$+b-Math.floor((v??0)/2);e.attr("x1",a).attr("y1",s).attr("x2",a).attr("y2",n).attr("stroke-width","4").attr("stroke",Da(t))}}return Ct(e,M),e.height=b,e.intersect=function(t){return Ut.rect(e,t)},l}async function Pa(t,e){const{labelStyles:a,nodeStyles:r}=S(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,halfPadding:o,label:h}=await vt(t,e,Pt(e)),c=i.width+10*o,d=i.height+8*o,g=.15*c,{cssStyles:y}=e,p=i.width+20,u=i.height+20,f=Math.max(c,p),m=Math.max(d,u);let x;h.attr("transform",`translate(${-i.width/2}, ${-i.height/2})`);const b=`M0 0 \n    a${g},${g} 1 0,0 ${.25*f},${-1*m*.1}\n    a${g},${g} 1 0,0 ${.25*f},0\n    a${g},${g} 1 0,0 ${.25*f},0\n    a${g},${g} 1 0,0 ${.25*f},${.1*m}\n\n    a${g},${g} 1 0,0 ${.15*f},${.33*m}\n    a${.8*g},${.8*g} 1 0,0 0,${.34*m}\n    a${g},${g} 1 0,0 ${-1*f*.15},${.33*m}\n\n    a${g},${g} 1 0,0 ${-1*f*.25},${.15*m}\n    a${g},${g} 1 0,0 ${-1*f*.25},0\n    a${g},${g} 1 0,0 ${-1*f*.25},0\n    a${g},${g} 1 0,0 ${-1*f*.25},${-1*m*.15}\n\n    a${g},${g} 1 0,0 ${-1*f*.1},${-1*m*.33}\n    a${.8*g},${.8*g} 1 0,0 0,${-1*m*.34}\n    a${g},${g} 1 0,0 ${.1*f},${-1*m*.33}\n  H0 V0 Z`;if("handDrawn"===e.look){const t=Mt.svg(l),a=w(e,{}),n=t.path(b,a);x=l.insert(()=>n,":first-child"),x.attr("class","basic label-container").attr("style",s(y))}else x=l.insert("path",":first-child").attr("class","basic label-container").attr("style",r).attr("d",b);return x.attr("transform",`translate(${-f/2}, ${-m/2})`),Ct(e,x),e.calcIntersect=function(t,e){return Ut.rect(t,e)},e.intersect=function(t){return n.info("Bang intersect",e,t),Ut.rect(e,t)},l}async function Ba(t,e){const{labelStyles:a,nodeStyles:r}=S(e);e.labelStyle=a;const{shapeSvg:l,bbox:i,halfPadding:o,label:h}=await vt(t,e,Pt(e)),c=i.width+2*o,d=i.height+2*o,g=.15*c,y=.25*c,p=.35*c,u=.2*c,{cssStyles:f}=e;let m;const x=`M0 0 \n    a${g},${g} 0 0,1 ${.25*c},${-1*c*.1}\n    a${p},${p} 1 0,1 ${.4*c},${-1*c*.1}\n    a${y},${y} 1 0,1 ${.35*c},${.2*c}\n\n    a${g},${g} 1 0,1 ${.15*c},${.35*d}\n    a${u},${u} 1 0,1 ${-1*c*.15},${.65*d}\n\n    a${y},${g} 1 0,1 ${-1*c*.25},${.15*c}\n    a${p},${p} 1 0,1 ${-1*c*.5},0\n    a${g},${g} 1 0,1 ${-1*c*.25},${-1*c*.15}\n\n    a${g},${g} 1 0,1 ${-1*c*.1},${-1*d*.35}\n    a${u},${u} 1 0,1 ${.1*c},${-1*d*.65}\n  H0 V0 Z`;if("handDrawn"===e.look){const t=Mt.svg(l),a=w(e,{}),n=t.path(x,a);m=l.insert(()=>n,":first-child"),m.attr("class","basic label-container").attr("style",s(f))}else m=l.insert("path",":first-child").attr("class","basic label-container").attr("style",r).attr("d",x);return h.attr("transform",`translate(${-i.width/2}, ${-i.height/2})`),m.attr("transform",`translate(${-c/2}, ${-d/2})`),Ct(e,m),e.calcIntersect=function(t,e){return Ut.rect(t,e)},e.intersect=function(t){return n.info("Cloud intersect",e,t),Ut.rect(e,t)},l}async function Aa(t,e){const{labelStyles:a,nodeStyles:s}=S(e);e.labelStyle=a;const{shapeSvg:n,bbox:r,halfPadding:l,label:i}=await vt(t,e,Pt(e)),o=r.width+8*l,h=r.height+2*l,c=`\n    M${-o/2} ${h/2-5}\n    v${10-h}\n    q0,-5 5,-5\n    h${o-10}\n    q5,0 5,5\n    v${h-10}\n    q0,5 -5,5\n    h${10-o}\n    q-5,0 -5,-5\n    Z\n  `,d=n.append("path").attr("id","node-"+e.id).attr("class","node-bkg node-"+e.type).attr("style",s).attr("d",c);return n.append("line").attr("class","node-line-").attr("x1",-o/2).attr("y1",h/2).attr("x2",o/2).attr("y2",h/2),i.attr("transform",`translate(${-r.width/2}, ${-r.height/2})`),n.append(()=>i.node()),Ct(e,d),e.calcIntersect=function(t,e){return Ut.rect(t,e)},e.intersect=function(t){return Ut.rect(e,t)},n}async function La(t,e){return re(t,e,{padding:e.padding??0})}r(Ca,"kanbanItem"),r(Pa,"bang"),r(Ba,"cloud"),r(Aa,"defaultMindmapNode"),r(La,"mindmapCircle");var Na=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:ta},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:Je},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:ea},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:ra},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:xe},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:re},{semanticName:"Bang",name:"Bang",shortName:"bang",description:"Bang",aliases:["bang"],handler:Pa},{semanticName:"Cloud",name:"Cloud",shortName:"cloud",description:"cloud",aliases:["cloud"],handler:Ba},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:Ze},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:ve},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:Oe},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:Ie},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:ya},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:Ne},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:we},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:oa},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:se},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:Ue},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:na},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:sa},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:$e},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:De},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:he},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:de},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:ye},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:We},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:fa},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:Me},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:ga},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:He},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:pe},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:be},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:ua},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:xa},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:Se},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:pa},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:ke},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Ke},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:Ve},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:qe},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:ee},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:ie},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:ia},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:la},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:ma},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:Xe},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:ze}],Ra=r(()=>{const t={state:aa,choice:ne,note:Fe,rectWithTitle:Ye,labelRect:Te,iconSquare:Ae,iconCircle:Pe,icon:Ce,iconRounded:Be,imageSquare:Le,anchor:Kt,kanbanItem:Ca,mindmapCircle:La,defaultMindmapNode:Aa,classBox:$a,erBox:ba,requirementBox:Ma},e=[...Object.entries(t),...Na.flatMap(t=>[t.shortName,..."aliases"in t?t.aliases:[],..."internalAliases"in t?t.internalAliases:[]].map(e=>[e,t.handler]))];return Object.fromEntries(e)},"generateShapeMap")();function Ta(t){return t in Ra}r(Ta,"isValidShape");var Ia=new Map;async function Oa(t,e,a){let s,n;"rect"===e.shape&&(e.rx&&e.ry?e.shape="roundedRect":e.shape="squareRect");const r=e.shape?Ra[e.shape]:void 0;if(!r)throw new Error(`No such shape: ${e.shape}. Please check your syntax.`);if(e.link){let l;"sandbox"===a.config.securityLevel?l="_top":e.linkTarget&&(l=e.linkTarget||"_blank"),s=t.insert("svg:a").attr("xlink:href",e.link).attr("target",l??null),n=await r(s,e,a)}else n=await r(t,e,a),s=n;return e.tooltip&&n.attr("title",e.tooltip),Ia.set(e.id,s),e.haveCallback&&s.attr("class",s.attr("class")+" clickable"),s}r(Oa,"insertNode");var Wa=r((t,e)=>{Ia.set(e.id,t)},"setNodeElem"),Ea=r(()=>{Ia.clear()},"clear"),_a=r(t=>{const e=Ia.get(t.id);n.trace("Transforming node",t.diff,t,"translate("+(t.x-t.width/2-5)+", "+t.width/2+")");const a=t.diff||0;return t.clusterNode?e.attr("transform","translate("+(t.x+a-t.width/2)+", "+(t.y-t.height/2-8)+")"):e.attr("transform","translate("+t.x+", "+t.y+")"),a},"positionNode");export{Oa as a,_a as c,Mt as d,jt as i,Wa as l,Ea as n,Ta as o,It as r,vt as s,Ht as t,Ct as u};